%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}


% Jupyter Notebook code cell colors
\definecolor{nbsphinxin}{HTML}{307FC1}
\definecolor{nbsphinxout}{HTML}{BF5B3D}
\definecolor{nbsphinx-code-bg}{HTML}{F5F5F5}
\definecolor{nbsphinx-code-border}{HTML}{E0E0E0}
\definecolor{nbsphinx-stderr}{HTML}{FFDDDD}
% ANSI colors for output streams and traceback highlighting
\definecolor{ansi-black}{HTML}{3E424D}
\definecolor{ansi-black-intense}{HTML}{282C36}
\definecolor{ansi-red}{HTML}{E75C58}
\definecolor{ansi-red-intense}{HTML}{B22B31}
\definecolor{ansi-green}{HTML}{00A250}
\definecolor{ansi-green-intense}{HTML}{007427}
\definecolor{ansi-yellow}{HTML}{DDB62B}
\definecolor{ansi-yellow-intense}{HTML}{B27D12}
\definecolor{ansi-blue}{HTML}{208FFB}
\definecolor{ansi-blue-intense}{HTML}{0065CA}
\definecolor{ansi-magenta}{HTML}{D160C4}
\definecolor{ansi-magenta-intense}{HTML}{A03196}
\definecolor{ansi-cyan}{HTML}{60C6C8}
\definecolor{ansi-cyan-intense}{HTML}{258F8F}
\definecolor{ansi-white}{HTML}{C5C1B4}
\definecolor{ansi-white-intense}{HTML}{A1A6B2}
\definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
\definecolor{ansi-default-inverse-bg}{HTML}{000000}

% Define an environment for non-plain-text code cell outputs (e.g. images)
\makeatletter
\newenvironment{nbsphinxfancyoutput}{%
    % Avoid fatal error with framed.sty if graphics too long to fit on one page
    \let\sphinxincludegraphics\nbsphinxincludegraphics
    \nbsphinx@image@maxheight\textheight
    \advance\nbsphinx@image@maxheight -2\fboxsep   % default \fboxsep 3pt
    \advance\nbsphinx@image@maxheight -2\fboxrule  % default \fboxrule 0.4pt
    \advance\nbsphinx@image@maxheight -\baselineskip
\def\nbsphinxfcolorbox{\spx@fcolorbox{nbsphinx-code-border}{white}}%
\def\FrameCommand{\nbsphinxfcolorbox\nbsphinxfancyaddprompt\@empty}%
\def\FirstFrameCommand{\nbsphinxfcolorbox\nbsphinxfancyaddprompt\sphinxVerbatim@Continues}%
\def\MidFrameCommand{\nbsphinxfcolorbox\sphinxVerbatim@Continued\sphinxVerbatim@Continues}%
\def\LastFrameCommand{\nbsphinxfcolorbox\sphinxVerbatim@Continued\@empty}%
\MakeFramed{\advance\hsize-\width\@totalleftmargin\z@\linewidth\hsize\@setminipage}%
\lineskip=1ex\lineskiplimit=1ex\raggedright%
}{\par\unskip\@minipagefalse\endMakeFramed}
\makeatother
\newbox\nbsphinxpromptbox
\def\nbsphinxfancyaddprompt{\ifvoid\nbsphinxpromptbox\else
    \kern\fboxrule\kern\fboxsep
    \copy\nbsphinxpromptbox
    \kern-\ht\nbsphinxpromptbox\kern-\dp\nbsphinxpromptbox
    \kern-\fboxsep\kern-\fboxrule\nointerlineskip
    \fi}
\newlength\nbsphinxcodecellspacing
\setlength{\nbsphinxcodecellspacing}{0pt}

% Define support macros for attaching opening and closing lines to notebooks
\newsavebox\nbsphinxbox
\makeatletter
\newcommand{\nbsphinxstartnotebook}[1]{%
    \par
    % measure needed space
    \setbox\nbsphinxbox\vtop{{#1\par}}
    % reserve some space at bottom of page, else start new page
    \needspace{\dimexpr2.5\baselineskip+\ht\nbsphinxbox+\dp\nbsphinxbox}
    % mimick vertical spacing from \section command
      \addpenalty\@secpenalty
      \@tempskipa 3.5ex \@plus 1ex \@minus .2ex\relax
      \addvspace\@tempskipa
      {\Large\@tempskipa\baselineskip
             \advance\@tempskipa-\prevdepth
             \advance\@tempskipa-\ht\nbsphinxbox
             \ifdim\@tempskipa>\z@
               \vskip \@tempskipa
             \fi}
    \unvbox\nbsphinxbox
    % if notebook starts with a \section, prevent it from adding extra space
    \@nobreaktrue\everypar{\@nobreakfalse\everypar{}}%
    % compensate the parskip which will get inserted by next paragraph
    \nobreak\vskip-\parskip
    % do not break here
    \nobreak
}% end of \nbsphinxstartnotebook

\newcommand{\nbsphinxstopnotebook}[1]{%
    \par
    % measure needed space
    \setbox\nbsphinxbox\vbox{{#1\par}}
    \nobreak % it updates page totals
    \dimen@\pagegoal
    \advance\dimen@-\pagetotal \advance\dimen@-\pagedepth
    \advance\dimen@-\ht\nbsphinxbox \advance\dimen@-\dp\nbsphinxbox
    \ifdim\dimen@<\z@
      % little space left
      \unvbox\nbsphinxbox
      \kern-.8\baselineskip
      \nobreak\vskip\z@\@plus1fil
      \penalty100
      \vskip\z@\@plus-1fil
      \kern.8\baselineskip
    \else
      \unvbox\nbsphinxbox
    \fi
}% end of \nbsphinxstopnotebook

% Ensure height of an included graphics fits in nbsphinxfancyoutput frame
\newdimen\nbsphinx@image@maxheight % set in nbsphinxfancyoutput environment
\newcommand*{\nbsphinxincludegraphics}[2][]{%
    \gdef\spx@includegraphics@options{#1}%
    \setbox\spx@image@box\hbox{\includegraphics[#1,draft]{#2}}%
    \in@false
    \ifdim \wd\spx@image@box>\linewidth
      \g@addto@macro\spx@includegraphics@options{,width=\linewidth}%
      \in@true
    \fi
    % no rotation, no need to worry about depth
    \ifdim \ht\spx@image@box>\nbsphinx@image@maxheight
      \g@addto@macro\spx@includegraphics@options{,height=\nbsphinx@image@maxheight}%
      \in@true
    \fi
    \ifin@
      \g@addto@macro\spx@includegraphics@options{,keepaspectratio}%
    \fi
    \setbox\spx@image@box\box\voidb@x % clear memory
    \expandafter\includegraphics\expandafter[\spx@includegraphics@options]{#2}%
}% end of "\MakeFrame"-safe variant of \sphinxincludegraphics
\makeatother

\makeatletter
\renewcommand*\sphinx@verbatim@nolig@list{\do\'\do\`}
\begingroup
\catcode`'=\active
\let\nbsphinx@noligs\@noligs
\g@addto@macro\nbsphinx@noligs{\let'\PYGZsq}
\endgroup
\makeatother
\renewcommand*\sphinxbreaksbeforeactivelist{\do\<\do\"\do\'}
\renewcommand*\sphinxbreaksafteractivelist{\do\.\do\,\do\:\do\;\do\?\do\!\do\/\do\>\do\-}
\makeatletter
\fvset{codes*=\sphinxbreaksattexescapedchars\do\^\^\let\@noligs\nbsphinx@noligs}
\makeatother



\title{Studienprojekt}
\date{Feb 16, 2021}
\release{}
\author{Kristoffer Schnieders}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{Grid points}
\label{\detokenize{examples/Grid_points:Grid-points}}\label{\detokenize{examples/Grid_points::doc}}
Here we show what kind of grids are used for the different quadratures.

Further more, there are two options, how many points are used for the probabilistic quadratures. (one or three points)

These options are compared afterwards.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k+kn}{from} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point} \PYG{k+kn}{import} \PYG{o}{*}
\end{sphinxVerbatim}
}


\section{One point for q = 1}
\label{\detokenize{examples/Grid_points:One-point-for-q-=-1}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{def} \PYG{n+nf}{grid\PYGZus{}points}\PYG{p}{(}\PYG{n}{quadrature}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{,} \PYG{n}{q}\PYG{p}{:} \PYG{n+nb}{int}\PYG{p}{,} \PYG{n}{a}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{b}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{list\PYGZus{}of\PYGZus{}points} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{n}{dim} \PYG{o}{=} \PYG{l+m+mi}{2}

    \PYG{c+c1}{\PYGZsh{} Because the points used for the deterministic quadratures are not changed, it is faster to call them}
    \PYG{c+c1}{\PYGZsh{} at the beginning before starting the Smolyak alg.}
    \PYG{k}{if} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Carlo}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{in} \PYG{n}{quadrature}\PYG{p}{:}
        \PYG{n}{q} \PYG{o}{=} \PYG{n}{q} \PYG{o}{+} \PYG{l+m+mi}{1}

    \PYG{c+c1}{\PYGZsh{} For every one dimensional degree of approx.  a weights and points vector}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{p}{(}\PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{n}{dim} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}

        \PYG{c+c1}{\PYGZsh{} One option for Newton\PYGZhy{}Cotes and Trapezoidal quadrature, because}
        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{or} \PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=}\PYG{n}{one\PYGZus{}dim\PYGZus{}trapezoidal}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{and} \PYG{n}{i} \PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{monte\PYGZus{}carlo\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}
            \PYG{n}{points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{concatenate}\PYG{p}{(}\PYG{p}{[}\PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{points}\PYG{p}{]}\PYG{p}{)}


        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o+ow}{or} \PYG{p}{(}\PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{and} \PYG{n}{i} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{)}  \PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{monte\PYGZus{}carlo\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{qmc\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{points}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Now we get the combinations of one\PYGZhy{}dimensional degrees of approx. in Q(q,d)}
    \PYG{n}{rng} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{q}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{n}{dim}
    \PYG{n}{rng} \PYG{o}{=} \PYG{p}{[}\PYG{n}{x} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{rng}\PYG{p}{]}

    \PYG{n}{possible\PYGZus{}combinations} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{set}\PYG{p}{(}\PYG{n}{i} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n}{itt}\PYG{o}{.}\PYG{n}{permutations}\PYG{p}{(}\PYG{n}{rng}\PYG{p}{,} \PYG{n}{dim}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{n}{dim}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{n+nb}{sum}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{n}{q} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{number\PYGZus{}approx} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{possible\PYGZus{}combinations}\PYG{p}{)}
    \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{number\PYGZus{}approx}\PYG{p}{)}\PYG{p}{:}

        \PYG{c+c1}{\PYGZsh{} gridpoints and the weight vectors are put into separate lists to make it easier to}
        \PYG{c+c1}{\PYGZsh{} make a meshgrid}
        \PYG{n}{current\PYGZus{}tuple} \PYG{o}{=} \PYG{n}{possible\PYGZus{}combinations}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
        \PYG{n}{current\PYGZus{}points} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

        \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{current\PYGZus{}tuple}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{current\PYGZus{}points}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{p}{[}\PYG{n}{current\PYGZus{}tuple}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} meshgrid yields a np.array with all coordinates needed for alg}
        \PYG{c+c1}{\PYGZsh{} coordinate and respective weight could be found in the same places in the array}
        \PYG{n}{meshgrid\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{meshgrid}\PYG{p}{(}\PYG{o}{*}\PYG{n}{current\PYGZus{}points}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{meshgrid\PYGZus{}points}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{meshgrid\PYGZus{}points}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}

    \PYG{k}{return} \PYG{p}{[}\PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x}\PYG{p}{,} \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y}\PYG{p}{]}

\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}plot\PYGZus{}of\PYGZus{}grids}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{option\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{grid\PYGZus{}list\PYGZus{}x}\PYG{p}{,} \PYG{n}{grid\PYGZus{}list\PYGZus{}y} \PYG{o}{=} \PYG{n}{grid\PYGZus{}points}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{n}{modified\PYGZus{}scatter\PYGZus{}plot}\PYG{p}{(}\PYG{n}{grid\PYGZus{}list\PYGZus{}x}\PYG{p}{,}\PYG{n}{grid\PYGZus{}list\PYGZus{}y}\PYG{p}{,}\PYG{n}{title}\PYG{o}{=}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{input\PYGZus{}list}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}


    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Gridpoints used for Smolyak\PYGZhy{}algorithm (one point)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{make\PYGZus{}plot\PYGZus{}of\PYGZus{}grids}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=902\sphinxpxdimen,height=978\sphinxpxdimen]{{examples_Grid_points_3_0}.png}

\end{nbsphinxfancyoutput}


\subsection{Here the grid points used for the approximation of the integral of a 2 dimensional function with the level of approximation q = 6 is shown, if one point is used for the one is used for probabilistic quadratures and q = 1. Apart form the upper left grid, the other grids change a little every time they are generated.}
\label{\detokenize{examples/Grid_points:Here-the-grid-points-used-for-the-approximation-of-the-integral-of-a-2-dimensional-function-with-the-level-of-approximation-q-=-6-is-shown,-if-one-point-is-used-for-the-one-is-used-for-probabilistic-quadratures-and-q-=-1.-Apart-form-the-upper-left-grid,-the-other-grids-change-a-little-every-time-they-are-generated.}}

\section{Three points for q = 1}
\label{\detokenize{examples/Grid_points:Three-points-for-q-=-1}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}three\PYGZus{}points} \PYG{k+kn}{import} \PYG{o}{*}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{def} \PYG{n+nf}{grid\PYGZus{}points}\PYG{p}{(}\PYG{n}{quadrature}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{,} \PYG{n}{q}\PYG{p}{:} \PYG{n+nb}{int}\PYG{p}{,} \PYG{n}{a}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{b}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{list\PYGZus{}of\PYGZus{}points} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{n}{dim} \PYG{o}{=} \PYG{l+m+mi}{2}
    \PYG{c+c1}{\PYGZsh{} Now for the  probabilistic quadratures, only one point is used for the first one\PYGZhy{}dimensional}
    \PYG{c+c1}{\PYGZsh{} degree of approximation. For this we add one to q, because otherwise the number of points for}
    \PYG{c+c1}{\PYGZsh{} the probabilistic quadratures would be much  smaller.}


    \PYG{c+c1}{\PYGZsh{} Now we apply the quadrature chosen by user}
    \PYG{c+c1}{\PYGZsh{} !! If quadratures is changed or extended in interface, please options here !!}

    \PYG{c+c1}{\PYGZsh{} Because the points used for the deterministic quadratures are not changed, it is faster to call them}
    \PYG{c+c1}{\PYGZsh{} at the beginning before starting the Smolyak alg.}


    \PYG{c+c1}{\PYGZsh{} For every one dimensional degree of approx.  a weights and points vector}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{p}{(}\PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{n}{dim} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}

        \PYG{c+c1}{\PYGZsh{} One option for Newton\PYGZhy{}Cotes and Trapezodial quadrature, because}
        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{or} \PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=}\PYG{n}{one\PYGZus{}dim\PYGZus{}trapezoidal}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{and} \PYG{n}{i} \PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{monte\PYGZus{}carlo\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}
            \PYG{n}{points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{concatenate}\PYG{p}{(}\PYG{p}{[}\PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{points}\PYG{p}{]}\PYG{p}{)}


        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o+ow}{or} \PYG{p}{(}\PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{and} \PYG{n}{i} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{)}  \PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{monte\PYGZus{}carlo\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{qmc\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{points}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Now we get the combinations of one\PYGZhy{}dimensional degrees of approx. in Q(q,d)}
    \PYG{n}{rng} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{q}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{n}{dim}
    \PYG{n}{rng} \PYG{o}{=} \PYG{p}{[}\PYG{n}{x} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{rng}\PYG{p}{]}

    \PYG{n}{possible\PYGZus{}combinations} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{set}\PYG{p}{(}\PYG{n}{i} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n}{itt}\PYG{o}{.}\PYG{n}{permutations}\PYG{p}{(}\PYG{n}{rng}\PYG{p}{,} \PYG{n}{dim}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{n}{dim}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{n+nb}{sum}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{n}{q} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{number\PYGZus{}approx} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{possible\PYGZus{}combinations}\PYG{p}{)}
    \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{number\PYGZus{}approx}\PYG{p}{)}\PYG{p}{:}

        \PYG{c+c1}{\PYGZsh{} the next two steps could be combined in one line.}
        \PYG{c+c1}{\PYGZsh{} what is done is, that first the tuple at position i is taken from the list of the set I.}
        \PYG{c+c1}{\PYGZsh{} Then the regarding vectors are taken from the list with the weight and points vectors and}
        \PYG{c+c1}{\PYGZsh{} are combined to a d dimensional point set}

        \PYG{c+c1}{\PYGZsh{} gridpoints and the weight vectors are put into separate lists to make it easier to}
        \PYG{c+c1}{\PYGZsh{} make a meshgrid}
        \PYG{n}{current\PYGZus{}tuple} \PYG{o}{=} \PYG{n}{possible\PYGZus{}combinations}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
        \PYG{n}{current\PYGZus{}points} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

        \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{current\PYGZus{}tuple}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{current\PYGZus{}points}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{p}{[}\PYG{n}{current\PYGZus{}tuple}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} meshgrid yields a np.array with all coordinates needed for alg}
        \PYG{c+c1}{\PYGZsh{} coordinate and respective weight could be found in the same places in the array}
        \PYG{n}{meshgrid\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{meshgrid}\PYG{p}{(}\PYG{o}{*}\PYG{n}{current\PYGZus{}points}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{meshgrid\PYGZus{}points}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{meshgrid\PYGZus{}points}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}

    \PYG{k}{return} \PYG{p}{[}\PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x}\PYG{p}{,} \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y}\PYG{p}{]}

\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}plot\PYGZus{}of\PYGZus{}grids}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{option\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{grid\PYGZus{}list\PYGZus{}x}\PYG{p}{,} \PYG{n}{grid\PYGZus{}list\PYGZus{}y} \PYG{o}{=} \PYG{n}{grid\PYGZus{}points}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{n}{modified\PYGZus{}scatter\PYGZus{}plot}\PYG{p}{(}\PYG{n}{grid\PYGZus{}list\PYGZus{}x}\PYG{p}{,}\PYG{n}{grid\PYGZus{}list\PYGZus{}y}\PYG{p}{,}\PYG{n}{title}\PYG{o}{=}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{input\PYGZus{}list}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}


    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Gridpoints used for Smolyak\PYGZhy{}algorithm (one point)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{make\PYGZus{}plot\PYGZus{}of\PYGZus{}grids}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=902\sphinxpxdimen,height=978\sphinxpxdimen]{{examples_Grid_points_7_0}.png}

\end{nbsphinxfancyoutput}

Here the grid points used for the approximation of the integral of a 2 dimensional function with the level of approximation q = 6 is shown, if one point is used for the one is used for probabilistic quadratures and q = 1. Apart form the upper left grid, the other grids change a little every time they are generated.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{Proof of principle}
\label{\detokenize{examples/Proof_of_principle:Proof-of-principle}}\label{\detokenize{examples/Proof_of_principle::doc}}

\section{One point for q = 1}
\label{\detokenize{examples/Proof_of_principle:One-point-for-q-=-1}}
We want to show that the approximations are working. For this we use an easy differential function. The result of the integral is 1. We only take low degrees of evaluation, because we only want to give a proof of principle. Quantitative evaluations comparisons are made afterwards for on a statistical basis.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{time} \PYG{k}{as} \PYG{n+nn}{time}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{bearcats}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{colors} \PYG{k}{as} \PYG{n+nn}{colors}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k+kn}{from} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point} \PYG{k+kn}{import} \PYG{o}{*}

\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{function\PYGZus{}string} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{pi**2/4 *sin(pi*x)*sin(pi*y)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{variables\PYGZus{}string} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{(x,y)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{option\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{result\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{results\PYGZus{}quad} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in}  \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{results\PYGZus{}quad}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{controller\PYGZus{}smolyak}\PYG{p}{(}\PYG{n}{function\PYGZus{}string}\PYG{p}{,} \PYG{n}{variables\PYGZus{}string}\PYG{p}{,} \PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{j}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{result\PYGZus{}list}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{results\PYGZus{}quad}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{result} \PYG{o}{=} \PYG{p}{[}\PYG{n}{result\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{p}{]}
    \PYG{n}{error}  \PYG{o}{=} \PYG{p}{[}\PYG{n}{result\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{p}{]}
    \PYG{n}{cost}   \PYG{o}{=} \PYG{p}{[}\PYG{n}{result\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{p}{]}
    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{result}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dotted}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mf}{1.9}\PYG{p}{,}\PYG{l+m+mf}{6.1}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Result of appoximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Result of Smolyak algorithm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{error}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{estimated error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{p}{[}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{result}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{real error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dotted}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mf}{1.9}\PYG{p}{,}\PYG{l+m+mf}{6.1}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error of Smolyak algorithm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,}  \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{error}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{0.1}\PYG{p}{,}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{error}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.4}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}


\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=912\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_2_0}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=901\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_2_1}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=901\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_2_2}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=912\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_2_3}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=912\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_2_4}.png}

\end{nbsphinxfancyoutput}

The result of the approximation and the error each should converge towards the dotted line. The estimated error for the probabilistic quadratures is not really significant, because the central limit theorem could not be applied here. The probabilistic quadratures for q\_i = 1 only uses one point. For this reason these quadratures are less exact.


\section{Three points for q = 1.}
\label{\detokenize{examples/Proof_of_principle:Three-points-for-q-=-1.}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[11]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{time} \PYG{k}{as} \PYG{n+nn}{time}
\PYG{k+kn}{from} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}three\PYGZus{}points} \PYG{k+kn}{import} \PYG{o}{*}

\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[12]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{function\PYGZus{}string} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{pi**2/4 *sin(pi*x)*sin(pi*y)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{variables\PYGZus{}string} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{(x,y)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{option\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{result\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{results\PYGZus{}quad} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in}  \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{results\PYGZus{}quad}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{controller\PYGZus{}smolyak}\PYG{p}{(}\PYG{n}{function\PYGZus{}string}\PYG{p}{,} \PYG{n}{variables\PYGZus{}string}\PYG{p}{,} \PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{j}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{result\PYGZus{}list}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{results\PYGZus{}quad}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{result} \PYG{o}{=} \PYG{p}{[}\PYG{n}{result\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{p}{]}
    \PYG{n}{error}  \PYG{o}{=} \PYG{p}{[}\PYG{n}{result\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{p}{]}
    \PYG{n}{cost}   \PYG{o}{=} \PYG{p}{[}\PYG{n}{result\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{p}{]}
    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{result}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dotted}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mf}{1.9}\PYG{p}{,}\PYG{l+m+mf}{6.1}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Result of appoximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Result of Smolyak algorithm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{error}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{estimated error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{p}{[}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{result}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{real error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dotted}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mf}{1.9}\PYG{p}{,}\PYG{l+m+mf}{6.1}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error of Smolyak algorithm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,}  \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{error}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{0.1}\PYG{p}{,}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{error}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.4}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}


\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=927\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_6_0}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=904\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_6_1}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=904\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_6_2}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=904\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_6_3}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=904\sphinxpxdimen,height=263\sphinxpxdimen]{{examples_Proof_of_principle_6_4}.png}

\end{nbsphinxfancyoutput}

The result of the approximation and the error each should converge towards the dotted line. The estimated error for the probabilistic quadratures is not really significant, because the central limit theorem could not be applied here. The probabilistic quadratures for q\_i = 1 here use three points.


\section{Higher dimension}
\label{\detokenize{examples/Proof_of_principle:Higher-dimension}}

\subsection{Approximation of constant}
\label{\detokenize{examples/Proof_of_principle:Approximation-of-constant}}
\begin{DUlineblock}{0em}
\item[] In the end, we want to show that the algorithm is working correct in different dimension. For this we first calculate the integral \(f_d(\vec{x}) = 1\), to see, if the Smolyak algorithm is working well. Here the only interesting point is the difference of the result to 1. This should be sufficiently small to be explainable by the machine epsilon. After this we calculated the integral of \(f_d(\vec{x}) = 2^d \cdot \prod_{i=0}^d x_i\) on the interval \([0,1]^d\). This integral is
approximated exact by the trapezoidal quadrature. Apart from that an impression of the error for the non\sphinxhyphen{}deterministic quadratures.
\item[] The data is loaded, because the calculation takes about 10 minutes. The calculations are repeated 10 times for q = d + 10.
\end{DUlineblock}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[13]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{color\PYGZus{}str} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{fuchsia}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{navy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{limegreen}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{red}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{font}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{weight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Data}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{approx\PYGZus{}simple\PYGZus{}highdim\PYGZus{}fct} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integral\PYGZus{}over\PYGZus{}one.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{approx\PYGZus{}simple\PYGZus{}highdim\PYGZus{}fct}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2, results}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.}\PYG{n}{shape}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}


\PYG{k}{for} \PYG{n}{dim} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{error} \PYG{o}{=} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{approx\PYGZus{}simple\PYGZus{}highdim\PYGZus{}fct}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{dim}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{, results}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}


    \PYG{c+c1}{\PYGZsh{} Time plot}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.8}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{n}{mat} \PYG{o}{=} \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].pcolor(error)
    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{colorbar}\PYG{p}{(}\PYG{n}{mat}\PYG{p}{,} \PYG{n}{ax}\PYG{o}{=}\PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)])

    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}ylabel(\PYGZdq{}quadrature\PYGZdq{},fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}yticks([0.5,1.5,2.5,3.5])
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}yticklabels([\PYGZdq{}N.C.\PYGZdq{},\PYGZdq{}T.\PYGZdq{}, \PYGZdq{}M.C.\PYGZdq{}, \PYGZdq{}Q.M.C.\PYGZdq{}],fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}xlabel(\PYGZdq{}degree of approximation q\PYGZdq{},fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}xticks([0.5,3.5,6.5,9.5])
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}xticklabels([dim,dim+3,dim+6,dim+9],fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}title(\PYGZdq{}Error in dimension \PYGZdq{}+ str(dim),fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})

\PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error for approximation of scalar in different dimensions}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=914\sphinxpxdimen,height=484\sphinxpxdimen]{{examples_Proof_of_principle_11_0}.png}

\end{nbsphinxfancyoutput}

It turns out that the error is in the suspected range of the machine epsilon. Furthermore, it is not systematically increasing with q. This means that the different summands used in the Smolyak algorithm are summed up in a proper way. The calculation was repeated 25 times and every time the error stayed the same.

The bottom line is 0, because the Newton\sphinxhyphen{}Cotes algorithm could not be applied for any one\sphinxhyphen{}dimensional q bigger 5. Up to that point no error occurred.


\subsection{Approximation of simple analytical function}
\label{\detokenize{examples/Proof_of_principle:Approximation-of-simple-analytical-function}}
Next we show the results of the approximation.

First we show the average of 25 calculation. As mentioned the deterministic quadratures are exact for this functions.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[14]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{color\PYGZus{}str} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{fuchsia}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{navy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{limegreen}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{red}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}


\PYG{n}{approx\PYGZus{}simple\PYGZus{}highdim\PYGZus{}fct} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integral\PYGZus{}over\PYGZus{}polynomial.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}


\PYG{k}{for} \PYG{n}{dim} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{approx} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{approx\PYGZus{}simple\PYGZus{}highdim\PYGZus{}fct}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{dim}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{, results}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}


    \PYG{c+c1}{\PYGZsh{} Time plot}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}

    \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(} \PYG{n}{approx}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color} \PYG{o}{=} \PYG{n}{color\PYGZus{}str}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{xmin}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{l+m+mi}{11}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{black}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{exact result}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{mean error of approximations}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{different approximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{)}\PYG{o}{\PYGZhy{}} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.2}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.6}\PYG{p}{,}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{)}\PYG{o}{\PYGZhy{}} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.2}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Dimension = }\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{dim}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{16}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Approximation of analytical function in different dimensions}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=923\sphinxpxdimen,height=977\sphinxpxdimen]{{examples_Proof_of_principle_15_0}.png}

\end{nbsphinxfancyoutput}

The deterministic quadratures are exact. The non deterministic quadratures tend to be relatively inaccurate especially in higher dimensions

Now the errors of the non\sphinxhyphen{}deterministic approximations are shown in a logarithmic scale.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[15]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{font}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{weight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{approx\PYGZus{}simple\PYGZus{}highdim\PYGZus{}fct} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integral\PYGZus{}over\PYGZus{}polynomial.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}


\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}


\PYG{k}{for} \PYG{n}{dim} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{error} \PYG{o}{=} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{approx\PYGZus{}simple\PYGZus{}highdim\PYGZus{}fct}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{dim}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{, results}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}


    \PYG{c+c1}{\PYGZsh{} Time plot}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.8}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{n}{mat} \PYG{o}{=} \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].pcolor(error,norm=colors.LogNorm(vmin=error.min(), vmax=error.max()),
                   \PYG{n}{cmap}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{brg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{colorbar}\PYG{p}{(}\PYG{n}{mat}\PYG{p}{,} \PYG{n}{ax}\PYG{o}{=}\PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)])

    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}ylabel(\PYGZdq{}quadrature\PYGZdq{},fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}yticks([0.5,1.5,2.5])
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}yticklabels([\PYGZdq{}M.C.n\PYGZdq{}, \PYGZdq{}M.C.n\PYGZhy{}n.\PYGZdq{}, \PYGZdq{}Q.M.C.\PYGZdq{}],fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}xlabel(\PYGZdq{}degree of approximation q\PYGZdq{},fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}xticks([0.5,3.5,6.5,9.5])
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}xticklabels([dim,dim+3,dim+6,dim+9],fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{2}, int((dim\PYGZhy{}3)/2)].set\PYGZus{}title(\PYGZdq{}Error in dimension \PYGZdq{}+ str(dim),fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})


\PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error for approximation of scalar in different dimensions}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=939\sphinxpxdimen,height=484\sphinxpxdimen]{{examples_Proof_of_principle_17_0}.png}

\end{nbsphinxfancyoutput}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{import Methodes\PYGZus{}Studienproject.Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point as Studieproject\PYGZus{}one}
\PYG{l+s+sd}{import numpy as np}
\PYG{l+s+sd}{import time}
\PYG{l+s+sd}{import pandas as bearcats}

\PYG{l+s+sd}{\PYGZsh{} for proof of pronciple}
\PYG{l+s+sd}{variables = [\PYGZdq{}(x\PYGZus{}1)\PYGZdq{}]}
\PYG{l+s+sd}{\PYGZsh{}function = [\PYGZdq{}1\PYGZdq{}]}
\PYG{l+s+sd}{functions = [\PYGZdq{}2 * x\PYGZus{}1\PYGZdq{}]}
\PYG{l+s+sd}{option\PYGZus{}list = [\PYGZdq{}Trapezoidal\PYGZdq{},}
\PYG{l+s+sd}{               \PYGZdq{}Monte Carlo (nested)\PYGZdq{},}
\PYG{l+s+sd}{               \PYGZdq{}Monte Carlo (non\PYGZhy{}nested)\PYGZdq{},}

\PYG{l+s+sd}{               \PYGZdq{}Quasi\PYGZhy{}Monte Carlo\PYGZdq{}]}
\PYG{l+s+sd}{repetions = 25}
\PYG{l+s+sd}{results = \PYGZob{}\PYGZcb{}}
\PYG{l+s+sd}{for dim in range(2,7):}
\PYG{l+s+sd}{    print(dim)}
\PYG{l+s+sd}{    variables.append(variables[\PYGZhy{}1][:\PYGZhy{}1]+\PYGZdq{}, x\PYGZus{}\PYGZdq{}+ str(dim)+\PYGZdq{})\PYGZdq{})}
\PYG{l+s+sd}{    functions.append(functions[\PYGZhy{}1]+\PYGZdq{}* 2 * x\PYGZus{}\PYGZdq{}+str(dim))}
\PYG{l+s+sd}{    \PYGZsh{} functions.append(functions[\PYGZhy{}1])}
\PYG{l+s+sd}{    results\PYGZus{}one\PYGZus{}dim= np.empty((4,10,repetions,3))}
\PYG{l+s+sd}{    run\PYGZus{}times = np.empty((4))}
\PYG{l+s+sd}{    for k\PYGZus{}1 in range(len(option\PYGZus{}list)):}

\PYG{l+s+sd}{        start = time.time()}
\PYG{l+s+sd}{        for k\PYGZus{}3  in range(dim,dim+10):}
\PYG{l+s+sd}{            print(k\PYGZus{}3)}
\PYG{l+s+sd}{            for k\PYGZus{}2 in range(repetions):}
\PYG{l+s+sd}{                results\PYGZus{}one\PYGZus{}dim[k\PYGZus{}1, k\PYGZus{}3\PYGZhy{}dim, k\PYGZus{}2, :] = Studieproject\PYGZus{}one.controller\PYGZus{}smolyak(functions[\PYGZhy{}1], variables[\PYGZhy{}1], option\PYGZus{}list[k\PYGZus{}1], k\PYGZus{}3)}
\PYG{l+s+sd}{            run\PYGZus{}times[k\PYGZus{}1] = (time.time()\PYGZhy{}start)/25}
\PYG{l+s+sd}{    new\PYGZus{}results = \PYGZob{} str(dim)+ \PYGZdq{}, results\PYGZdq{}: results\PYGZus{}one\PYGZus{}dim[:,:,:,0], str(dim)+ \PYGZdq{}, time\PYGZdq{}: run\PYGZus{}times\PYGZcb{}}
\PYG{l+s+sd}{    results.update(new\PYGZus{}results)}
\PYG{l+s+sd}{bearcats.to\PYGZus{}pickle(results,\PYGZdq{}integral\PYGZus{}over\PYGZus{}polynomial.pkl\PYGZdq{})}
\PYG{l+s+sd}{\PYGZsh{} bearcats.to\PYGZus{}pickle(results,\PYGZdq{}integral\PYGZus{}over\PYGZus{}one.pkl\PYGZdq{})}
\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{If you want to generate data, remove quotation marks.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
If you want to generate data, remove quotation marks.
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{Approximate \protect\(\pi\protect\)}
\label{\detokenize{examples/Approxim_pi:Approximate-_pi}}\label{\detokenize{examples/Approxim_pi::doc}}
The way not not steady functions could be used in the project is illustrated in a well known basic example for the use of the Monte Carlo method. This is the approximation of pi. Here the it is used that the area of the (unit) circle is proportional to pi. Hence it is possible to approximate \(\pi\) by setting all points in the circle to 1 and all others to 0. Then the average of these value converges to \(\pi\). Because we restrict our self to the interval \([0,1]^n\), we have
\begin{equation*}
\begin{split}\pi = 4 \cdot A(2,q)\end{split}
\end{equation*}
and
\begin{equation*}
\begin{split}\pi = 6 \cdot A(3,q),\end{split}
\end{equation*}
with \(A(n,q)\) being the result of the Smolyak algorithm in \(n\) dimensions and the degree of approximation q. Because the function is not derivable, it is not possible to estimate the error for the algorithm for the deterministic quadratures. We will just compare them to the value of \(\pi\) used by numpy.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}


\PYG{k+kn}{import} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point} \PYG{k}{as} \PYG{n+nn}{Studieproject\PYGZus{}one}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{sympy} \PYG{k}{as} \PYG{n+nn}{sp}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{itertools} \PYG{k}{as} \PYG{n+nn}{itt}

\end{sphinxVerbatim}
}


\section{The functions used}
\label{\detokenize{examples/Approxim_pi:The-functions-used}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Functions receiving 2 or 3 matrices of the the dimension 2 or 3. Each matirce contains the coordinate in}
\PYG{c+c1}{\PYGZsh{} the component x, y or z. The function returns a martice of the shape of the input components with 1 if}
\PYG{c+c1}{\PYGZsh{} the 2\PYGZhy{}norm of the coordinate is smaller or equal 1 and 0 otherwise.}
\PYG{k}{def} \PYG{n+nf}{circle}\PYG{p}{(}\PYG{n}{X\PYGZus{}1}\PYG{p}{,} \PYG{n}{X\PYGZus{}2}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{save\PYGZus{}mat} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{X\PYGZus{}1}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{)}

    \PYG{k}{for} \PYG{n}{index\PYGZus{}vec}\PYG{p}{,} \PYG{n}{vectors} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{X\PYGZus{}1}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{index\PYGZus{}col}\PYG{p}{,} \PYG{n}{x\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{vectors}\PYG{p}{)}\PYG{p}{:}

            \PYG{k}{if} \PYG{n}{x\PYGZus{}1}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{X\PYGZus{}2}\PYG{p}{[}\PYG{n}{index\PYGZus{}vec}\PYG{p}{,} \PYG{n}{index\PYGZus{}col}\PYG{p}{]}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{1}\PYG{p}{:}
                \PYG{n}{save\PYGZus{}mat}\PYG{p}{[}\PYG{n}{index\PYGZus{}vec}\PYG{p}{,} \PYG{n}{index\PYGZus{}col}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{k}{return} \PYG{n}{save\PYGZus{}mat}

\PYG{k}{def} \PYG{n+nf}{ball}\PYG{p}{(}\PYG{n}{X\PYGZus{}1}\PYG{p}{,} \PYG{n}{X\PYGZus{}2}\PYG{p}{,} \PYG{n}{X\PYGZus{}3}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{save\PYGZus{}mat} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{X\PYGZus{}1}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{index\PYGZus{}mat}\PYG{p}{,} \PYG{n}{matrix} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{X\PYGZus{}1}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{index\PYGZus{}vec}\PYG{p}{,} \PYG{n}{vectors} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{matrix}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{for} \PYG{n}{index\PYGZus{}col}\PYG{p}{,} \PYG{n}{x\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{vectors}\PYG{p}{)}\PYG{p}{:}

                \PYG{k}{if} \PYG{n}{x\PYGZus{}1}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{X\PYGZus{}2}\PYG{p}{[}\PYG{n}{index\PYGZus{}mat}\PYG{p}{,} \PYG{n}{index\PYGZus{}vec}\PYG{p}{,} \PYG{n}{index\PYGZus{}col}\PYG{p}{]}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{X\PYGZus{}3}\PYG{p}{[}\PYG{n}{index\PYGZus{}mat}\PYG{p}{,} \PYG{n}{index\PYGZus{}vec}\PYG{p}{,} \PYG{n}{index\PYGZus{}col}\PYG{p}{]}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{1}\PYG{p}{:}
                    \PYG{n}{save\PYGZus{}mat}\PYG{p}{[}\PYG{n}{index\PYGZus{}mat}\PYG{p}{,} \PYG{n}{index\PYGZus{}vec}\PYG{p}{,} \PYG{n}{index\PYGZus{}col}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{k}{return} \PYG{n}{save\PYGZus{}mat}
\PYG{n}{color\PYGZus{}str} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{fuchsia}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{navy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{limegreen}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{red}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{variables\PYGZus{}string\PYGZus{}rewrite} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{(x\PYGZus{}1, x\PYGZus{}2, x\PYGZus{}3)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{variables\PYGZus{}string\PYGZus{}rewrite} \PYG{o}{=} \PYG{n}{variables\PYGZus{}string\PYGZus{}rewrite}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{variables} \PYG{o}{=} \PYG{n}{variables\PYGZus{}string\PYGZus{}rewrite}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{)(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{variables\PYGZus{}string\PYGZus{}rewrite} \PYG{o}{=} \PYG{n}{variables\PYGZus{}string\PYGZus{}rewrite}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{)(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{variables}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
    \PYG{k}{raise} \PYG{n+ne}{Exception}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{There at least has to be one variable.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{f} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{variables}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{variables}\PYG{p}{[}\PYG{n}{f}\PYG{p}{]} \PYG{o}{=} \PYG{n}{sp}\PYG{o}{.}\PYG{n}{Symbol}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{x\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{f}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{option\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} Approximation of pi with different q and degrees of approx.}
\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{]}
\PYG{n}{approx\PYGZus{}pi\PYGZus{}circle} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound} \PYG{o}{\PYGZhy{}} \PYG{n}{lower\PYGZus{}bound}\PYG{p}{]}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{index\PYGZus{}option}\PYG{p}{,} \PYG{n}{option} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{for} \PYG{n}{index\PYGZus{}q}\PYG{p}{,} \PYG{n}{degree\PYGZus{}of\PYGZus{}approx} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{approx\PYGZus{}pi\PYGZus{}circle}\PYG{p}{[}\PYG{n}{index\PYGZus{}option}\PYG{p}{,} \PYG{n}{index\PYGZus{}q}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{4} \PYG{o}{*} \PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{controller\PYGZus{}smolyak}\PYG{p}{(}\PYG{n}{circle}\PYG{p}{,} \PYG{n}{variables}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{option}\PYG{p}{,} \PYG{n}{degree\PYGZus{}of\PYGZus{}approx}\PYG{p}{,} \PYG{n}{function\PYGZus{}given}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{no\PYGZus{}error}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}

\PYG{n}{approx\PYGZus{}pi\PYGZus{}ball} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound} \PYG{o}{\PYGZhy{}} \PYG{n}{lower\PYGZus{}bound}\PYG{p}{]}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{index\PYGZus{}option}\PYG{p}{,} \PYG{n}{option} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{for} \PYG{n}{index\PYGZus{}q}\PYG{p}{,} \PYG{n}{degree\PYGZus{}of\PYGZus{}approx} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{approx\PYGZus{}pi\PYGZus{}ball}\PYG{p}{[}\PYG{n}{index\PYGZus{}option}\PYG{p}{,} \PYG{n}{index\PYGZus{}q}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{6} \PYG{o}{*} \PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{controller\PYGZus{}smolyak}\PYG{p}{(}\PYG{n}{ball}\PYG{p}{,} \PYG{n}{variables}\PYG{p}{,} \PYG{n}{option}\PYG{p}{,} \PYG{n}{degree\PYGZus{}of\PYGZus{}approx}\PYG{p}{,} \PYG{n}{function\PYGZus{}given}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{no\PYGZus{}error}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}

\end{sphinxVerbatim}
}


\section{Illustration of the principle of approximation for 2 dimensions}
\label{\detokenize{examples/Approxim_pi:Illustration-of-the-principle-of-approximation-for-2-dimensions}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{font}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{weight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k}{def} \PYG{n+nf}{grid\PYGZus{}points}\PYG{p}{(}\PYG{n}{quadrature}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{,} \PYG{n}{q}\PYG{p}{:} \PYG{n+nb}{int}\PYG{p}{,} \PYG{n}{a}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{b}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{list\PYGZus{}of\PYGZus{}points} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{n}{dim} \PYG{o}{=} \PYG{l+m+mi}{2}

    \PYG{c+c1}{\PYGZsh{} Because the points used for the deterministic quadratures are not changed, it is faster to call them}
    \PYG{c+c1}{\PYGZsh{} at the beginning before starting the Smolyak alg.}
    \PYG{k}{if} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Carlo}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{in} \PYG{n}{quadrature}\PYG{p}{:}
        \PYG{n}{q} \PYG{o}{=} \PYG{n}{q} \PYG{o}{+} \PYG{l+m+mi}{1}

    \PYG{c+c1}{\PYGZsh{} For every one dimensional degree of approx.  a weights and points vector}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{p}{(}\PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{n}{dim} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}

        \PYG{c+c1}{\PYGZsh{} One option for Newton\PYGZhy{}Cotes and Trapezoidal quadrature, because}
        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{or} \PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{one\PYGZus{}dim\PYGZus{}trapezoidal}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{and} \PYG{n}{i} \PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{monte\PYGZus{}carlo\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}
            \PYG{n}{points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{concatenate}\PYG{p}{(}\PYG{p}{[}\PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{points}\PYG{p}{]}\PYG{p}{)}


        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o+ow}{or} \PYG{p}{(}\PYG{n}{quadrature} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{and} \PYG{n}{i} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{)}  \PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{monte\PYGZus{}carlo\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{quadrature} \PYG{o}{==}  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
            \PYG{n}{points}\PYG{p}{,} \PYG{n}{weights} \PYG{o}{=} \PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{qmc\PYGZus{}quad}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}

        \PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{points}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Now we get the combinations of one\PYGZhy{}dimensional degrees of approx. in Q(q,d)}
    \PYG{n}{rng} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{q}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{n}{dim}
    \PYG{n}{rng} \PYG{o}{=} \PYG{p}{[}\PYG{n}{x} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{rng}\PYG{p}{]}

    \PYG{n}{possible\PYGZus{}combinations} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{set}\PYG{p}{(}\PYG{n}{i} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n}{itt}\PYG{o}{.}\PYG{n}{permutations}\PYG{p}{(}\PYG{n}{rng}\PYG{p}{,} \PYG{n}{dim}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{n}{dim}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{n+nb}{sum}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{n}{q} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{number\PYGZus{}approx} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{possible\PYGZus{}combinations}\PYG{p}{)}
    \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{number\PYGZus{}approx}\PYG{p}{)}\PYG{p}{:}

        \PYG{c+c1}{\PYGZsh{} gridpoints and the weight vectors are put into separate lists to make it easier to}
        \PYG{c+c1}{\PYGZsh{} make a meshgrid}
        \PYG{n}{current\PYGZus{}tuple} \PYG{o}{=} \PYG{n}{possible\PYGZus{}combinations}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
        \PYG{n}{current\PYGZus{}points} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

        \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{current\PYGZus{}tuple}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{current\PYGZus{}points}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{list\PYGZus{}of\PYGZus{}points}\PYG{p}{[}\PYG{n}{current\PYGZus{}tuple}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} meshgrid yields a np.array with all coordinates needed for alg}
        \PYG{c+c1}{\PYGZsh{} coordinate and respective weight could be found in the same places in the array}
        \PYG{n}{meshgrid\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{meshgrid}\PYG{p}{(}\PYG{o}{*}\PYG{n}{current\PYGZus{}points}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{meshgrid\PYGZus{}points}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{meshgrid\PYGZus{}points}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}

    \PYG{k}{return} \PYG{p}{[}\PYG{n}{meshgrid\PYGZus{}list\PYGZus{}x}\PYG{p}{,} \PYG{n}{meshgrid\PYGZus{}list\PYGZus{}y}\PYG{p}{]}

\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}plot\PYGZus{}of\PYGZus{}grids}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{a} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{n}{b} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{n}{option\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
    \PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{x}\PYG{p}{,} \PYG{n}{y} \PYG{o}{=} \PYG{n}{grid\PYGZus{}points}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}
        \PYG{n}{circle\PYGZus{}pi} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{index\PYGZus{}x}\PYG{p}{,} \PYG{n}{\PYGZus{}} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{:}

            \PYG{n}{circle\PYGZus{}pi}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{circle}\PYG{p}{(}\PYG{n}{x}\PYG{p}{[}\PYG{n}{index\PYGZus{}x}\PYG{p}{]}\PYG{p}{,} \PYG{n}{y}\PYG{p}{[}\PYG{n}{index\PYGZus{}x}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{ax}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZpc{}}\PYG{k}{2},int(i/2)].scatter(x[index\PYGZus{}x][circle\PYGZus{}pi[\PYGZhy{}1]==1], y[index\PYGZus{}x][circle\PYGZus{}pi[\PYGZhy{}1]==1], color=\PYGZdq{}blue\PYGZdq{},label=\PYGZdq{}1\PYGZdq{})
            \PYG{n}{ax}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZpc{}}\PYG{k}{2},int(i/2)].scatter(x[index\PYGZus{}x][circle\PYGZus{}pi[\PYGZhy{}1]==0], y[index\PYGZus{}x][circle\PYGZus{}pi[\PYGZhy{}1]==0], color=\PYGZdq{}red\PYGZdq{},label=\PYGZdq{}0\PYGZdq{})
            \PYG{n}{ax}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZpc{}}\PYG{k}{2},int(i/2)].set\PYGZus{}title(option\PYGZus{}list[i],fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})

        \PYG{c+c1}{\PYGZsh{} print circle}
        \PYG{n}{x\PYGZus{}circle} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{/} \PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}
        \PYG{n}{r\PYGZus{}x} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{x\PYGZus{}circle}\PYG{p}{)}
        \PYG{n}{r\PYGZus{}y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{x\PYGZus{}circle}\PYG{p}{)}
        \PYG{n}{ax}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZpc{}}\PYG{k}{2},int(i/2)].plot(r\PYGZus{}x,r\PYGZus{}y,color=\PYGZdq{}blue\PYGZdq{})

    \PYG{c+c1}{\PYGZsh{} Some cosmetic changes in plot}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{x\PYGZhy{}values}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{y\PYGZhy{}value}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{n}{a} \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{b} \PYG{o}{+} \PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mi}{10}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{n}{a} \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{b} \PYG{o}{+} \PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mi}{10}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}



    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Illustration of principle}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{make\PYGZus{}plot\PYGZus{}of\PYGZus{}grids}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=883\sphinxpxdimen,height=978\sphinxpxdimen]{{examples_Approxim_pi_6_0}.png}

\end{nbsphinxfancyoutput}

The blue points coincides with the points with value 1 and the red ones with the value 0.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{index\PYGZus{}option}\PYG{p}{,} \PYG{n}{option} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{\PYGZhy{}}\PYG{n}{approx\PYGZus{}pi\PYGZus{}circle}\PYG{p}{[}\PYG{n}{index\PYGZus{}option}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color} \PYG{o}{=} \PYG{n}{color\PYGZus{}str}\PYG{p}{[}\PYG{n}{index\PYGZus{}option}\PYG{p}{]}\PYG{p}{,}
             \PYG{n}{label}\PYG{o}{=}\PYG{n}{option}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{l+m+mf}{0.000005}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{error of A(2,q)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xticks}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xticklabels}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error of A(2,q) approximating \PYGZdl{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{pi\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}


\PYG{k}{for} \PYG{n}{index\PYGZus{}option}\PYG{p}{,} \PYG{n}{option} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{\PYGZhy{}}\PYG{n}{approx\PYGZus{}pi\PYGZus{}ball}\PYG{p}{[}\PYG{n}{index\PYGZus{}option}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color} \PYG{o}{=} \PYG{n}{color\PYGZus{}str}\PYG{p}{[}\PYG{n}{index\PYGZus{}option}\PYG{p}{]}\PYG{p}{,}
             \PYG{n}{label}\PYG{o}{=}\PYG{n}{option}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{error of A(3,q)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xticks}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xticklabels}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{,} \PYG{n}{upper\PYGZus{}bound}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error of A(3,q) approximating \PYGZdl{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{pi\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{l+m+mf}{0.00001}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=912\sphinxpxdimen,height=345\sphinxpxdimen]{{examples_Approxim_pi_8_0}.png}

\end{nbsphinxfancyoutput}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{Statistical evaluation for error for probabilistic quadratures}
\label{\detokenize{examples/Stat_evaluation_for_prob_quad :Statistical-evaluation-for-error-for-probabilistic-quadratures}}\label{\detokenize{examples/Stat_evaluation_for_prob_quad ::doc}}
In this script we want to evaluate statistical data. For this we load data, which was calculated and saved in a .cvs/ .pkt file, because generating file takes some hours.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k+kn}{from} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point} \PYG{k+kn}{import} \PYG{o}{*}
\end{sphinxVerbatim}
}


\section{First approximation of distribution}
\label{\detokenize{examples/Stat_evaluation_for_prob_quad :First-approximation-of-distribution}}

\subsection{One point for q = 1}
\label{\detokenize{examples/Stat_evaluation_for_prob_quad :One-point-for-q-=-1}}
First we want to give a feeling for the distribution of the results of the Smolyak algorithm using different quadratures and the effect of higher degrees of approximation.

We only show the first degrees of approximation, because otherwise nothing could be seen, due to the scaling of the plot.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[11]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Data}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:}
    \PYG{k}{pass}
\PYG{n}{results\PYGZus{}one} \PYG{o}{=} \PYG{n}{load\PYGZus{}stat\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{stat\PYGZus{}approach\PYGZus{}2\PYGZus{}to\PYGZus{}20\PYGZus{}result\PYGZus{}13\PYGZus{}11\PYGZus{}one.csv}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{results\PYGZus{}three} \PYG{o}{=} \PYG{n}{load\PYGZus{}stat\PYGZus{}data}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{stat\PYGZus{}approach\PYGZus{}2\PYGZus{}to\PYGZus{}20\PYGZus{}result\PYGZus{}13\PYGZus{}11\PYGZus{}three.csv}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[12]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{title\PYGZus{}string} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{One point for q = 1 on the one dimensional level }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{ Monte Carlo quadrature (nested)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo quadrature (non\PYGZhy{}nested)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo quadrature }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{n}{results} \PYG{o}{=} \PYG{n}{results\PYGZus{}one}
\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{boxprops} \PYG{o}{=} \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{whiskerprops} \PYG{o}{=} \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{medianprops} \PYG{o}{=} \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{k\PYGZus{}2} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{y} \PYG{o}{=}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}
        \PYG{n}{bp} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,} \PYG{n}{positions} \PYG{o}{=} \PYG{p}{[}\PYG{n}{k\PYGZus{}2} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{widths} \PYG{o}{=} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n}{boxprops}\PYG{o}{=}\PYG{n}{boxprops}\PYG{p}{,}
                        \PYG{n}{whiskerprops} \PYG{o}{=} \PYG{n}{whiskerprops}\PYG{p}{,} \PYG{n}{medianprops} \PYG{o}{=} \PYG{n}{medianprops}\PYG{p}{)}
        \PYG{n}{x} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{k\PYGZus{}2}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dotted}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mf}{1.5}\PYG{p}{,}  \PYG{l+m+mf}{5.5}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.5}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{n}{title\PYGZus{}string}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=} \PYG{l+m+mi}{16}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}


\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=1161\sphinxpxdimen,height=544\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__7_0}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=1161\sphinxpxdimen,height=488\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__7_1}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=1161\sphinxpxdimen,height=488\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__7_2}.png}

\end{nbsphinxfancyoutput}

Boxplot of at least 200 calculations of the function \(\pi^2/4 \cdot sin(\pi\cdot x)\cdot sin(\pi\cdot y)\) using probabilistic quadratures . Here q = 2 in implies that we the integral is approximated by a point evaluation. Thus, the high variance for low q is expected.

By taking a look at the the variance of the result and comparing it to the error estimation, we get a more quantitative impression about the goodness of the approximation


\subsection{Three points}
\label{\detokenize{examples/Stat_evaluation_for_prob_quad :Three-points}}
For comparison we also show the result, if for q = 1 on the one dimensional level we use 3 points.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[13]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{title\PYGZus{}string} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Three points for q = 1 on the one dimensional level }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{ Monte Carlo quadrature (nested)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo quadrature (non\PYGZhy{}nested)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo quadrature }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{n}{results} \PYG{o}{=} \PYG{n}{results\PYGZus{}three}
\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{boxprops} \PYG{o}{=} \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{whiskerprops} \PYG{o}{=} \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{medianprops} \PYG{o}{=} \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mf}{3.0}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{k\PYGZus{}2} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{y} \PYG{o}{=}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}
        \PYG{n}{bp} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,} \PYG{n}{positions} \PYG{o}{=} \PYG{p}{[}\PYG{n}{k\PYGZus{}2} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{widths} \PYG{o}{=} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n}{boxprops}\PYG{o}{=}\PYG{n}{boxprops}\PYG{p}{,}
                        \PYG{n}{whiskerprops} \PYG{o}{=} \PYG{n}{whiskerprops}\PYG{p}{,} \PYG{n}{medianprops} \PYG{o}{=} \PYG{n}{medianprops}\PYG{p}{)}
        \PYG{n}{x} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{k\PYGZus{}2}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dotted}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mf}{1.5}\PYG{p}{,}  \PYG{l+m+mf}{5.5}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.5}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{n}{title\PYGZus{}string}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=} \PYG{l+m+mi}{16}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}


\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=1161\sphinxpxdimen,height=544\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__12_0}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=1161\sphinxpxdimen,height=488\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__12_1}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=1161\sphinxpxdimen,height=488\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__12_2}.png}

\end{nbsphinxfancyoutput}

The approximation in this case is much more exact. A comparison of the runtime and the smaller error will be done later on.


\section{Statistical parameters of distribution of results}
\label{\detokenize{examples/Stat_evaluation_for_prob_quad :Statistical-parameters-of-distribution-of-results}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[14]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Calculation of mean an variance of the result and estimated error of approximation}
\PYG{n}{mean\PYGZus{}result} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{sigma\PYGZus{}result} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{mean\PYGZus{}error} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{sigma\PYGZus{}error} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{runtime} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{runtime\PYGZus{}sig} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}


\PYG{k}{for} \PYG{n}{k\PYGZus{}3} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}3} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{results} \PYG{o}{=} \PYG{n}{results\PYGZus{}one}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{results} \PYG{o}{=} \PYG{n}{results\PYGZus{}three}

    \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{k\PYGZus{}2} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{mean\PYGZus{}result}\PYG{p}{[}\PYG{n}{k\PYGZus{}3}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}
            \PYG{n}{mean\PYGZus{}error}\PYG{p}{[}\PYG{n}{k\PYGZus{}3}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} We again choose the 95 \PYGZpc{} level}
            \PYG{n}{sigma\PYGZus{}result}\PYG{p}{[}\PYG{n}{k\PYGZus{}3}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{var}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{sigma\PYGZus{}error}\PYG{p}{[}\PYG{n}{k\PYGZus{}3}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{var}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}

            \PYG{n}{runtime}\PYG{p}{[}\PYG{n}{k\PYGZus{}3}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}
            \PYG{n}{runtime\PYGZus{}sig}\PYG{p}{[}\PYG{n}{k\PYGZus{}3}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{var}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{} What can be found in the different dimensions of the matrices: shape: (2,3,23):}
\PYG{c+c1}{\PYGZsh{} x: x= 0 q\PYGZus{}i uses one point, x=1 q\PYGZus{}i uses three points;}
\PYG{c+c1}{\PYGZsh{} y: y=0 Monte Carlo (nested), y=1 Monte Carlo (non\PYGZhy{}nested), y=2 Quasi\PYGZhy{}Monte Carlo (nested)}
\PYG{c+c1}{\PYGZsh{} z: element related to z = q\PYGZhy{}2}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[15]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{sklearn} \PYG{k+kn}{import} \PYG{n}{datasets}\PYG{p}{,} \PYG{n}{linear\PYGZus{}model}
\PYG{n}{color\PYGZus{}code} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{r\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{g\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{b\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{r\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{g\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{b\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{r:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{g:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{b:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{legend\PYGZus{}label} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo quadrature (nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo quadrature (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo quadrature}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{:}

    \PYG{c+c1}{\PYGZsh{} solution not beautiful. Result of afterwards implementing algorithm with one point used for q\PYGZus{}i = 1.}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{1}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}

    \PYG{n}{mean\PYGZus{}error\PYGZus{}real} \PYG{o}{=} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{mean\PYGZus{}result}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{mean\PYGZus{}sigma\PYGZus{}real} \PYG{o}{=} \PYG{n}{sigma\PYGZus{}result}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{}    plt.subplots\PYGZus{}adjust(hspace=0.4, wspace=0.4)}

    \PYG{n}{degree\PYGZus{}of\PYGZus{}app} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}2} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{mean\PYGZus{}error\PYGZus{}real}\PYG{p}{,}\PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{legend\PYGZus{}label}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{mean\PYGZus{}error\PYGZus{}real}\PYG{p}{,}\PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{n+nb}{min}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{mean\PYGZus{}result}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{,}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{mean\PYGZus{}result}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.5}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1e\PYGZhy{}8}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{mean error of the approximations}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Mean error of the approximation depending on the degree of approximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
          \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=927\sphinxpxdimen,height=401\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__16_0}.png}

\end{nbsphinxfancyoutput}

This graphic shows the mean of the real error of the different approximations. The solid lines are related to the approximations using one point for q\_i = 1, while the dotted lines were calculated for q\_i = 3. The points for q near 24 are statistically speaking less significant because about 25 approximations were calculated.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[16]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{:}

    \PYG{c+c1}{\PYGZsh{} solution not beautiful. Result of afterwards implementing algorithm with one point used for q\PYGZus{}i = 1.}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{1}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}
\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{} solution not beautiful. Result of afterwards implementing algorithm with one point used for q\PYGZus{}i = 1.}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{1}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}

    \PYG{n}{mean\PYGZus{}error\PYGZus{}est}  \PYG{o}{=} \PYG{n}{mean\PYGZus{}error}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}

    \PYG{n}{s\PYGZus{}mean} \PYG{o}{=} \PYG{n}{sigma\PYGZus{}result}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}
    \PYG{n}{s\PYGZus{}error}  \PYG{o}{=} \PYG{n}{sigma\PYGZus{}error}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}
    \PYG{n}{mean\PYGZus{}error\PYGZus{}real} \PYG{o}{=} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{mean\PYGZus{}result}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{mean\PYGZus{}sigma\PYGZus{}real} \PYG{o}{=} \PYG{n}{sigma\PYGZus{}result}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}


    \PYG{n}{degree\PYGZus{}of\PYGZus{}app} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{errorbar}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{mean\PYGZus{}error\PYGZus{}est}\PYG{p}{,} \PYG{n}{s\PYGZus{}error}\PYG{p}{,}\PYG{n}{ecolor}\PYG{o}{=}\PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
                 \PYG{n}{color}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}\PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{capsize}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{mean\PYGZus{}error\PYGZus{}est}\PYG{p}{,} \PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{o}{+}\PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}2} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{mean\PYGZus{}error\PYGZus{}real}\PYG{p}{,}\PYG{n}{s\PYGZus{}mean}\PYG{p}{)}\PYG{p}{,}\PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{o}{+} \PYG{n}{k\PYGZus{}2} \PYG{o}{*} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{n}{legend\PYGZus{}label}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{mean\PYGZus{}error\PYGZus{}real}\PYG{p}{,}\PYG{n}{s\PYGZus{}mean}\PYG{p}{)}\PYG{p}{,}\PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{o}{+} \PYG{n}{k\PYGZus{}2} \PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{:}
        \PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}
        \PYG{n}{regression\PYGZus{}data\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{n}{math}\PYG{o}{.}\PYG{n}{log2}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{mean\PYGZus{}error\PYGZus{}real}\PYG{p}{,}\PYG{n}{s\PYGZus{}mean}\PYG{p}{)}\PYG{p}{]}
        \PYG{n}{regr} \PYG{o}{=} \PYG{n}{linear\PYGZus{}model}\PYG{o}{.}\PYG{n}{LinearRegression}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{regr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
        \PYG{n}{regr}\PYG{o}{.}\PYG{n}{score}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
        \PYG{n}{exponent} \PYG{o}{=} \PYG{n}{regr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}

        \PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}
        \PYG{n}{regression\PYGZus{}data\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{n}{math}\PYG{o}{.}\PYG{n}{log2}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{mean\PYGZus{}error\PYGZus{}real}\PYG{p}{,}\PYG{n}{s\PYGZus{}mean}\PYG{p}{)}\PYG{p}{]}
        \PYG{n}{regr} \PYG{o}{=} \PYG{n}{linear\PYGZus{}model}\PYG{o}{.}\PYG{n}{LinearRegression}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{regr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
        \PYG{n}{regr}\PYG{o}{.}\PYG{n}{score}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
        \PYG{n}{exponent} \PYG{o}{=} \PYG{n}{regr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}

        \PYG{n}{regression\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{mean\PYGZus{}error\PYGZus{}real}\PYG{p}{,}\PYG{n}{s\PYGZus{}mean}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mf}{1.3}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{n}{exponent}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{*}\PYG{p}{(}\PYG{n}{x} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}  \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{k:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{if} \PYG{n}{k\PYGZus{}2} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{:}
            \PYG{n}{plt}\PYG{o}{.}\PYG{n}{annotate}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{propto 2\PYGZca{}}\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{\PYGZhy{}0.9\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{[}\PYG{l+m+mi}{19}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{n}{xytext}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{o}{*}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{n+nb}{min}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{mean\PYGZus{}error\PYGZus{}real}\PYG{p}{,}\PYG{n}{s\PYGZus{}mean}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{0.2}\PYG{p}{)}\PYG{p}{,}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{mean\PYGZus{}error}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mf}{1.5}\PYG{p}{,}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{o}{+}\PYG{l+m+mf}{0.5}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{mean error of the approximations}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Comparison of estimated and real error.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
          \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=924\sphinxpxdimen,height=401\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__18_0}.png}

\end{nbsphinxfancyoutput}

The dotted lines are the error estimations for the different quadratures. The upper one is related to the calculations using one point for q\_i = 1. The lower lines show the error within a confidence level of 95 \%.”. The real error bound nearly decreases proportional to 2 ** (\sphinxhyphen{}1), if the Quasi\sphinxhyphen{}Monte Carlo quadrature is used. The exponent is varying a little with respect to the generated data used.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[18]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{:}

    \PYG{c+c1}{\PYGZsh{} solution not beautiful. Result of afterwards implementing algorithm with one point used for q\PYGZus{}i = 1.}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{1}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}
\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{} solution not beautiful. Result of afterwards implementing algorithm with one point used for q\PYGZus{}i = 1.}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{1}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{k\PYGZus{}2} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{k\PYGZus{}1} \PYG{o}{=} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{3}
    \PYG{n}{runtime\PYGZus{}mean} \PYG{o}{=} \PYG{n}{runtime}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}
    \PYG{n}{runtime\PYGZus{}sigma} \PYG{o}{=} \PYG{n}{runtime\PYGZus{}sig}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}

    \PYG{n}{degree\PYGZus{}of\PYGZus{}app} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{runtime\PYGZus{}mean}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{k\PYGZus{}2} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{runtime\PYGZus{}mean}\PYG{p}{,}\PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{legend\PYGZus{}label}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{runtime\PYGZus{}mean}\PYG{p}{,}\PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1} \PYG{o}{+} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{errorbar}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{runtime\PYGZus{}mean}\PYG{p}{,} \PYG{n}{runtime\PYGZus{}sigma}\PYG{p}{,}\PYG{n}{ecolor}\PYG{o}{=}\PYG{n}{color\PYGZus{}code}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
                 \PYG{n}{color}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}\PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{capsize}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{:}


        \PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}
        \PYG{n}{regression\PYGZus{}data\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{n}{math}\PYG{o}{.}\PYG{n}{log2}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n}{runtime\PYGZus{}mean}\PYG{p}{]}
        \PYG{n}{regr} \PYG{o}{=} \PYG{n}{linear\PYGZus{}model}\PYG{o}{.}\PYG{n}{LinearRegression}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{regr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
        \PYG{n}{regr}\PYG{o}{.}\PYG{n}{score}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
        \PYG{n}{exponent} \PYG{o}{=} \PYG{n}{regr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}


        \PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{21}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}
        \PYG{n}{regression\PYGZus{}data\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{n}{math}\PYG{o}{.}\PYG{n}{log2}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n}{runtime\PYGZus{}mean}\PYG{p}{[}\PYG{l+m+mi}{19}\PYG{p}{:}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{]}\PYG{p}{]}
        \PYG{n}{regr} \PYG{o}{=} \PYG{n}{linear\PYGZus{}model}\PYG{o}{.}\PYG{n}{LinearRegression}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{regr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
        \PYG{n}{regr}\PYG{o}{.}\PYG{n}{score}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
        \PYG{n}{exponent} \PYG{o}{=} \PYG{n}{regr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}
        \PYG{n}{regression\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{n}{regr}\PYG{o}{.}\PYG{n}{intercept\PYGZus{}} \PYG{o}{+} \PYG{n}{exponent}\PYG{o}{*}\PYG{n}{x}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{o}{+}\PYG{n}{degree\PYGZus{}of\PYGZus{}app}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{k:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{k\PYGZus{}2} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{:}
            \PYG{n}{plt}\PYG{o}{.}\PYG{n}{annotate}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{propto 2\PYGZca{}}\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{\PYGZhy{}1.1\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{[}\PYG{l+m+mi}{19}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{n}{xytext}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{[}\PYG{l+m+mi}{19}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{n+nb}{min}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{runtime}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{,}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{runtime}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.5}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,} \PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Degree of approximation q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Runtime per call of approximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{results}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Runtime of programm depending on the degree of approximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
          \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}


\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=924\sphinxpxdimen,height=401\sphinxpxdimen]{{examples_Stat_evaluation_for_prob_quad__20_0}.png}

\end{nbsphinxfancyoutput}

It could be seen that the difference between the three quadratures is minor for this example. The variance of the runtime is relatively low. The observed runtime did not change fundamentally for changes in the implementation, such that this might be a related to the algorithm itself.


\subsection{Code used for generation of evaluated data.}
\label{\detokenize{examples/Stat_evaluation_for_prob_quad :Code-used-for-generation-of-evaluated-data.}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{import Methodes\PYGZus{}Studienproject.Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point as Studieproject\PYGZus{}one}

\PYG{l+s+sd}{Studieproject\PYGZus{}one.calculate\PYGZus{}stat\PYGZus{}data(\PYGZdq{}pi\PYGZca{}2/4 sin(pi*x)sin(pi*y)\PYGZdq{}, \PYGZdq{}(x,y)\PYGZdq{}, [\PYGZdq{}Monte Carlo (nested)\PYGZdq{},\PYGZdq{}Monte Carlo (non\PYGZhy{}nested)\PYGZdq{},\PYGZdq{}Quasi\PYGZhy{}Monte Carlo\PYGZdq{}]}
\PYG{l+s+sd}{   , \PYGZdq{}stat\PYGZus{}approach\PYGZus{}2\PYGZus{}to\PYGZus{}20\PYGZus{}result\PYGZus{}1\PYGZus{}12\PYGZus{}one.csv\PYGZdq{},}
\PYG{l+s+sd}{                                      [2, 25], repetitions=2 ** 10, damping=True, damping\PYGZus{}exp=1.2)}
\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}

\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{import Methodes\PYGZus{}Studienproject.Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}three\PYGZus{}points as Studieproject\PYGZus{}three}

\PYG{l+s+sd}{Studieproject\PYGZus{}three.calculate\PYGZus{}stat\PYGZus{}data(\PYGZdq{}pi\PYGZca{}2/4 sin(pi*x)sin(pi*y)\PYGZdq{}, \PYGZdq{}(x,y)\PYGZdq{}, [\PYGZdq{}Monte Carlo (nested)\PYGZdq{}, \PYGZdq{}Monte Carlo (non\PYGZhy{}nested)\PYGZdq{},\PYGZdq{}Quasi\PYGZhy{}Monte Carlo\PYGZdq{}]}
\PYG{l+s+sd}{    , \PYGZdq{}stat\PYGZus{}approach\PYGZus{}2\PYGZus{}to\PYGZus{}20\PYGZus{}result\PYGZus{}1\PYGZus{}12\PYGZus{}three.csv\PYGZdq{}, [2, 23], repetitions=2 ** 10, damping=True,}
\PYG{l+s+sd}{                        damping\PYGZus{}exp=1.2)}
\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Approximation of analytical function in 2 dimensions. (Three points)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Approximation of analytical function in 2 dimensions. (Three points)
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{Example 15.2.6: Periodic Functions (modified)}
\label{\detokenize{examples/Periodic_function:Example-15.2.6:-Periodic-Functions-(modified)}}\label{\detokenize{examples/Periodic_function::doc}}
This is an easy example of a function fulfilling those conditions that make it possible to apply the results of example 15.2.6. In the example the classical Wiener measure is used. This measure sofar is not implemented in this project, such that the results of of this section do not hold for these examples. Nevertheless, the results are compared with the results using the Lebesgue measure. If the use of the Wiener measure is implemented, the example easily could be modified.

In example 15.2.6. in one dimension it is assumed that you have a r\sphinxhyphen{}times continuously differentiable function with period \(\beta\). Then the norm of this space \(F_1 = \tilde{C}^{r}([0,\beta])\) could be written as
\begin{equation*}
\begin{split}||f||_{F_1}=|f(0)| + \max_{t\in [0,\beta]}|f^{(r)}(t)|\end{split}
\end{equation*}
.

If we now assume \(f^{(i)}(0)=f^{(i)}(\beta)=0\) for all \(i \in 1, 2, \dots, r\), we have for the d dimensional case
\begin{equation*}
\begin{split}||f||_{F_d}=\max_{t\in [0,\beta]^{d}}|f^{(r,r,\dots,r)}(t)|\end{split}
\end{equation*}
.

Using the information \(N_i (f) = [f(\frac{\beta}{m_i+1}), f(\frac{2\cdot \beta}{m_i+1}), \dots, f(\frac{m_i\cdot \beta}{m_i+1})]\) we use the algorithm
\begin{equation*}
\begin{split}U_i (f) = \frac{\beta}{m_i}\sum^{m_i}_{j_1} f\left(\frac{j\beta}{m_1 +1}\right)\end{split}
\end{equation*}
to approximate the integral. This coincides with the open trapezoidal quadrature. The rest of the properties of the approximation are explained afterwards.

First we take a quick look at the function
\begin{equation*}
\begin{split}f_1(x,t) = \min(x,t),\end{split}
\end{equation*}
which is in \(\tilde{C}^{0}([0,1])\). It is possible to calculate that the
\begin{equation*}
\begin{split}\int_{[0,1]^{2}} f_1(\vec{x}) d\vec{x} = \frac{1}{3}\end{split}
\end{equation*}
holds. The real cost of the reaching of a specific error is compared with the estimated cost in the rear part of the section.

After this we take a look at some easy functions \(\tilde{C}^{r-1}([0,1])\), with \(r>0\).

Here the one dimensional function we chose is
\begin{equation*}
\begin{split}f_{r} (x)=\left(\prod^{\lfloor r/2\rfloor}_{k = 1} \frac{2k-1}{2k}\right) \cdot \sin^r(2\pi \cdot x),\end{split}
\end{equation*}
which especially is in \(\tilde{C}^{r-1}([0,1])\), with \(f(0)=f(1)=1.\) The result of the integral \$:nbsphinx\sphinxhyphen{}math:\sphinxtitleref{int}\sphinxstyleemphasis{\{{[}0,1{]}\{d\}\}:nbsphinx\sphinxhyphen{}math:\textasciigrave{}prod\textasciigrave{}\{d\}}\{k=1\} 2 \cdot `:nbsphinx-math:sin\textasciigrave{}\textasciicircum{}2(2:nbsphinx\sphinxhyphen{}math:\sphinxtitleref{pi \textasciigrave{}:nbsphinx\sphinxhyphen{}math:}cdot \sphinxtitleref{x\_k)d:nbsphinx\sphinxhyphen{}math:}vec\{x\}\textasciigrave{} \$ could be determined analytically to be 1 for even \(r\) and \(d \in \mathbb{N}\) and 0 for uneven \(r\) and \(d \in \mathbb{N}\).

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}


\PYG{k+kn}{import} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point} \PYG{k}{as} \PYG{n+nn}{Studieproject\PYGZus{}one}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{bearcats}
\PYG{k+kn}{import} \PYG{n+nn}{scipy}
\PYG{k+kn}{import} \PYG{n+nn}{sympy} \PYG{k}{as} \PYG{n+nn}{sp}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{itertools} \PYG{k}{as} \PYG{n+nn}{itt}
\PYG{k+kn}{import} \PYG{n+nn}{math}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn} \PYG{k+kn}{import} \PYG{n}{datasets}\PYG{p}{,} \PYG{n}{linear\PYGZus{}model}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{font}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{weight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\end{sphinxVerbatim}
}


\section{Example on page 358}
\label{\detokenize{examples/Periodic_function:Example-on-page-358}}
First we show the calculate the approximation of \(f_1 (x,t)\) and the approximation given on page 358.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[11]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{IPython}\PYG{n+nn}{.}\PYG{n+nn}{display} \PYG{k+kn}{import} \PYG{n}{display}\PYG{p}{,} \PYG{n}{Math}

\PYG{c+c1}{\PYGZsh{} other properties of the example}
\PYG{n}{r} \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{n}{beta} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{q} \PYG{o}{=} \PYG{l+m+mi}{2}
\PYG{n}{dim} \PYG{o}{=} \PYG{l+m+mi}{2}
\PYG{n}{m\PYGZus{}i} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*}\PYG{o}{*} \PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}

\PYG{c+c1}{\PYGZsh{} Specific error properties of periodic functions of this kind}
\PYG{n}{C\PYGZus{}r} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{scipy}\PYG{o}{.}\PYG{n}{special}\PYG{o}{.}\PYG{n}{bernoulli}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{r}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{o}{/}\PYG{n}{math}\PYG{o}{.}\PYG{n}{factorial}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{r}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{e\PYGZus{}one\PYGZus{}a} \PYG{o}{=}  \PYG{n}{C\PYGZus{}r} \PYG{o}{*} \PYG{n}{beta} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{r}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{e\PYGZus{}one\PYGZus{}b} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{r} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Cost and error esimation for the one dimensional error}
\PYG{n}{B}\PYG{p}{,} \PYG{n}{C}\PYG{p}{,} \PYG{n}{D}\PYG{p}{,} \PYG{n}{F\PYGZus{}0}\PYG{p}{,} \PYG{n}{F} \PYG{o}{=} \PYG{p}{[}\PYG{n}{e\PYGZus{}one\PYGZus{}a}\PYG{p}{,} \PYG{n}{e\PYGZus{}one\PYGZus{}a}\PYG{p}{,} \PYG{n}{e\PYGZus{}one\PYGZus{}b}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} calculation of the approximation and the error and cost estimation}
\PYG{c+c1}{\PYGZsh{} of the example}
\PYG{n}{option} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{deg\PYGZus{}approx} \PYG{o}{=} \PYG{l+m+mi}{18}
\PYG{k}{def} \PYG{n+nf}{max\PYGZus{}fun}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{t}\PYG{p}{)}\PYG{p}{:}
\PYG{c+c1}{\PYGZsh{} implementation of the function given on page 358 for input like used in}
\PYG{c+c1}{\PYGZsh{} implementation of algorithm.}
    \PYG{k}{return} \PYG{n}{np}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{n}{x}\PYG{p}{,}\PYG{n}{t}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}

\PYG{n}{variables} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
\PYG{k}{for} \PYG{n}{f} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{dim}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{variables}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{sp}\PYG{o}{.}\PYG{n}{Symbol}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{x\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{f}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{result\PYGZus{}max\PYGZus{}fun} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{deg\PYGZus{}approx}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{cost\PYGZus{}and\PYGZus{}err\PYGZus{}estim} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{eps\PYGZus{}ind}\PYG{p}{,} \PYG{n}{epsilon} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{p}{[}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{m\PYGZus{}i} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*}\PYG{o}{*} \PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}
    \PYG{n}{cost\PYGZus{}and\PYGZus{}err\PYGZus{}estim}\PYG{p}{[}\PYG{n}{eps\PYGZus{}ind}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{fast\PYGZus{}eps\PYGZus{}cost}\PYG{p}{(}\PYG{n}{dim}\PYG{p}{,} \PYG{n}{B}\PYG{p}{,} \PYG{n}{C}\PYG{p}{,} \PYG{n}{D}\PYG{p}{,} \PYG{n}{F\PYGZus{}0}\PYG{p}{,} \PYG{n}{F}\PYG{p}{,} \PYG{n}{epsilon}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{p}{:}\PYG{l+m+mi}{6}\PYG{p}{]}

\PYG{k}{for} \PYG{n}{q} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{dim}\PYG{p}{,} \PYG{n}{dim} \PYG{o}{+} \PYG{n}{deg\PYGZus{}approx}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{result\PYGZus{}max\PYGZus{}fun}\PYG{p}{[}\PYG{n}{q}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{controller\PYGZus{}smolyak}\PYG{p}{(}\PYG{n}{max\PYGZus{}fun}\PYG{p}{,} \PYG{n}{variables}\PYG{p}{,} \PYG{n}{option}\PYG{p}{,} \PYG{n}{q}\PYG{p}{,} \PYG{n}{function\PYGZus{}given}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{no\PYGZus{}error}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{example\PYGZus{}2}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{]}

\PYG{n}{result\PYGZus{}max\PYGZus{}fun}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{result\PYGZus{}max\PYGZus{}fun}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}
\end{sphinxVerbatim}
}

We here want to show that the function calculating the estimation works properly.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[12]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{estim\PYGZus{}cost\PYGZus{}error} \PYG{o}{=}\PYG{n}{Studieproject\PYGZus{}one}\PYG{o}{.}\PYG{n}{fast\PYGZus{}eps\PYGZus{}cost}\PYG{p}{(}\PYG{n}{dim}\PYG{p}{,} \PYG{n}{B}\PYG{p}{,} \PYG{n}{C}\PYG{p}{,} \PYG{n}{D}\PYG{p}{,} \PYG{n}{F\PYGZus{}0}\PYG{p}{,} \PYG{n}{F}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{)}
\PYG{n}{meaning} \PYG{o}{=}\PYG{p}{[}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{cost(A\PYGZus{}}\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{epsilon\PYGZcb{}(d))}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{alpha}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{alpha\PYGZus{}0}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{alpha\PYGZus{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{alpha\PYGZus{}2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{alpha\PYGZus{}3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{n}{display}\PYG{p}{(}\PYG{n}{Math}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ \PYGZdl{}We chose \PYGZdl{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{epsilon}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{} = \PYGZdl{} }\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{frac}\PYG{l+s+si}{\PYGZob{}1\PYGZcb{}}\PYG{l+s+si}{\PYGZob{}8\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{This leads to:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{index}\PYG{p}{,} \PYG{n}{var} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{meaning}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{display}\PYG{p}{(}\PYG{n}{Math}\PYG{p}{(}\PYG{n}{var}\PYG{o}{+}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{} = \PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{estim\PYGZus{}cost\PYGZus{}error}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{display}\PYG{p}{(}\PYG{n}{Math}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ \PYGZdl{}This coincides with the values diplayed on the pages 368 and 369. For bigger values of  \PYGZdl{} }\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{epsilon, \PYGZdl{} the cost\PYGZhy{}estimation is not a number. In this reagion the estimation will be seen to be bigger than actual values.\PYGZdl{} }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}
$\displaystyle  $We chose $\epsilon$ = $ \frac{1}{8}$
\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
This leads to:
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}
$\displaystyle cost(A_{\epsilon}(d))$ = $0.4141$
\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}
$\displaystyle \alpha$ = $1.0$
\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}
$\displaystyle \alpha_0$ = $3.3902$
\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}
$\displaystyle \alpha_1$ = $-0.5762$
\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}
$\displaystyle \alpha_2$ = $2.7098$
\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}
$\displaystyle \alpha_3$ = $1.5$
\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}
$\displaystyle  $This coincides with the values diplayed on the pages 368 and 369. For bigger values of  $ \epsilon, $ the cost-estimation is not a number. In this reagion the estimation will be seen to be bigger than actual values.$ $
\end{nbsphinxfancyoutput}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[36]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{result\PYGZus{}max\PYGZus{}fun}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{result\PYGZus{}max\PYGZus{}fun}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{red}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{calculations}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{result\PYGZus{}max\PYGZus{}fun}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{regression\PYGZus{}data\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]} \PYG{k}{for} \PYG{n}{k\PYGZus{}2} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{result\PYGZus{}max\PYGZus{}fun}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{regr} \PYG{o}{=} \PYG{n}{linear\PYGZus{}model}\PYG{o}{.}\PYG{n}{LinearRegression}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{regr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
\PYG{n}{regr}\PYG{o}{.}\PYG{n}{score}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
\PYG{n}{exponent} \PYG{o}{=} \PYG{n}{regr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}

\PYG{n}{regression\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{e}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{n}{regr}\PYG{o}{.}\PYG{n}{intercept\PYGZus{}} \PYG{o}{+} \PYG{n}{exponent}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{k:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{annotate}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{propto 10\PYGZca{}}\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{\PYGZhy{}1.25\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{n}{xytext}\PYG{o}{=}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mf}{1.1}\PYG{p}{)}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(} \PYG{p}{[}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cost\PYGZus{}and\PYGZus{}err\PYGZus{}estim}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{blue}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{cost(\PYGZdl{}A\PYGZus{}}\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{epsilon\PYGZcb{}(2)\PYGZdl{})}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]} \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{p}{[}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{regression\PYGZus{}data\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]} \PYG{k}{for} \PYG{n}{k\PYGZus{}2} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{cost\PYGZus{}and\PYGZus{}err\PYGZus{}estim}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{regr} \PYG{o}{=} \PYG{n}{linear\PYGZus{}model}\PYG{o}{.}\PYG{n}{LinearRegression}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{regr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
\PYG{n}{regr}\PYG{o}{.}\PYG{n}{score}\PYG{p}{(}\PYG{n}{regression\PYGZus{}data\PYGZus{}x} \PYG{p}{,} \PYG{n}{regression\PYGZus{}data\PYGZus{}y}\PYG{p}{)}
\PYG{n}{exponent} \PYG{o}{=} \PYG{n}{regr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}

\PYG{n}{regression\PYGZus{}y} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{n}{regr}\PYG{o}{.}\PYG{n}{intercept\PYGZus{}} \PYG{o}{+} \PYG{n}{exponent}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{k:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{annotate}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{propto 10\PYGZca{}}\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{\PYGZhy{}1.13\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{[}\PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{n}{xytext}\PYG{o}{=}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{25}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mf}{1.3}\PYG{p}{,}\PYG{n}{regression\PYGZus{}y}\PYG{p}{[}\PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{17}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{both}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Cost}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error\PYGZdl{}\PYGZca{}}\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{\PYGZhy{}1\PYGZcb{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Comparison of estimated and real error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
          \PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=915\sphinxpxdimen,height=409\sphinxpxdimen]{{examples_Periodic_function_7_0}.png}

\end{nbsphinxfancyoutput}

The error scales in a surprisingly nice way, such that the error bound holds for the function \(f_1(\vec{x})\) for almost every point. We once again remind the reader that the error bound could not be applied to the calculation without changing the measure used in this project.


\section{Example 2: Functions in \protect\(f \in \tilde{C}^r([0,1])\protect\) with \protect\(r > 0\protect\) and higher dimensions}
\label{\detokenize{examples/Periodic_function:Example-2:-Functions-in-f-_in-_tilde_C__r(_0,1_)-with-r->-0-and-higher-dimensions}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} We from now on use l instead of r to make clear that the sofar the results of section 15.2.6 could not be applied.}

\PYG{n}{beta} \PYG{o}{=} \PYG{l+m+mi}{1}


\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Data}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:}
    \PYG{k}{pass}

\PYG{n}{color\PYGZus{}str} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{navy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{crimson}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{forestgreen}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{cornflowerblue}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{darkorange}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} Structure of data: [r, dim,q,:]}
\PYG{n}{result\PYGZus{}per\PYGZus{}func} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{approx\PYGZus{}per\PYGZus{}function.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{result\PYGZus{}per\PYGZus{}func} \PYG{o}{=} \PYG{n}{result\PYGZus{}per\PYGZus{}func}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{results}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{c+c1}{\PYGZsh{}[:\PYGZhy{}1,:,:,:]}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{result\PYGZus{}per\PYGZus{}func}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{25}\PYG{p}{)}\PYG{p}{)}


\PYG{k}{for} \PYG{n}{l} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{result\PYGZus{}per\PYGZus{}func}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{result\PYGZus{}per\PYGZus{}func\PYGZus{}l} \PYG{o}{=} \PYG{n}{result\PYGZus{}per\PYGZus{}func}\PYG{p}{[}\PYG{n}{l}\PYG{p}{,}\PYG{p}{:}\PYG{p}{,}\PYG{p}{:}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}
    \PYG{n}{l\PYGZus{}real} \PYG{o}{=} \PYG{l+m+mi}{0}

    \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{} These calculations are not made because the estimations are not met.}
\PYG{l+s+sd}{    In further implementation it might be possible to use them}


\PYG{l+s+sd}{    \PYGZsh{} Specific error properties of periodic functions of this kind}
\PYG{l+s+sd}{    C\PYGZus{}r = np.sqrt(abs(scipy.special.bernoulli(2+2*r\PYGZus{}real)[\PYGZhy{}1])/math.factorial(2*r\PYGZus{}real+2))}
\PYG{l+s+sd}{    e\PYGZus{}one\PYGZus{}a =  C\PYGZus{}r * beta ** ((2*r\PYGZus{}real+3)/2)}
\PYG{l+s+sd}{    e\PYGZus{}one\PYGZus{}b = 2 ** (\PYGZhy{}(r\PYGZus{}real + 1))}

\PYG{l+s+sd}{    \PYGZsh{} Cost and error esimation for the one dimensional error}
\PYG{l+s+sd}{    B, C, D, F\PYGZus{}0, F = [e\PYGZus{}one\PYGZus{}a, e\PYGZus{}one\PYGZus{}a, e\PYGZus{}one\PYGZus{}b, 1, 2]}
\PYG{l+s+sd}{    \PYGZsq{}\PYGZsq{}\PYGZsq{}}

    \PYG{k}{for} \PYG{n}{dim} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{result\PYGZus{}per\PYGZus{}func\PYGZus{}l}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{dim\PYGZus{}real} \PYG{o}{=} \PYG{n}{dim}\PYG{o}{+}\PYG{l+m+mi}{2}
        \PYG{c+c1}{\PYGZsh{} We want to take a look at the error, not the value of the approximation.}
        \PYG{k}{if} \PYG{n}{l}\PYG{o}{\PYGZpc{}}\PYG{k}{2}==0:
            \PYG{n}{error} \PYG{o}{=} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{result\PYGZus{}per\PYGZus{}func\PYGZus{}l}\PYG{p}{[}\PYG{n}{dim}\PYG{p}{,}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{k}{else}\PYG{p}{:}
             \PYG{n}{error} \PYG{o}{=} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{result\PYGZus{}per\PYGZus{}func\PYGZus{}l}\PYG{p}{[}\PYG{n}{dim}\PYG{p}{,}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{result\PYGZus{}per\PYGZus{}func\PYGZus{}l}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{1000}

        \PYG{n}{cost}  \PYG{o}{=} \PYG{n}{result\PYGZus{}per\PYGZus{}func\PYGZus{}l}\PYG{p}{[}\PYG{n}{dim}\PYG{p}{,}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}

        \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{        cost\PYGZus{}estim = []}
\PYG{l+s+sd}{        epsilons = [(1/2)**(20*l+k\PYGZus{}1) for k\PYGZus{}1 in range(error.shape[0])]}
\PYG{l+s+sd}{        for eps in epsilons:}
\PYG{l+s+sd}{            cost\PYGZus{}estim.append(Studieproject\PYGZus{}one.fast\PYGZus{}eps\PYGZus{}cost(dim\PYGZus{}real, B, C, D, F\PYGZus{}0, F, eps)[0])}
\PYG{l+s+sd}{        \PYGZsq{}\PYGZsq{}\PYGZsq{}}

        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}
        \PYG{n}{ax}\PYG{p}{[}\PYG{n}{l}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{cost}\PYG{p}{,} \PYG{n}{error}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dimension d = }\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

    \PYG{n}{ax}\PYG{p}{[}\PYG{n}{l}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{ax}\PYG{p}{[}\PYG{n}{l}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{ax}\PYG{p}{[}\PYG{n}{l}\PYG{p}{]}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{ax}\PYG{p}{[}\PYG{n}{l}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Relationship  between error and cost os caluclation for \PYGZdl{}}\PYG{l+s+s2}{\PYGZbs{}}\PYG{l+s+s2}{mathbf}\PYG{l+s+si}{\PYGZob{}l\PYGZcb{}}\PYG{l+s+s2}{ = \PYGZdl{} }\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{l}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{ax}\PYG{p}{[}\PYG{n}{l}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{cost}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{ax}\PYG{p}{[}\PYG{n}{l}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error for approximation of scalar in different dimensions}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=919\sphinxpxdimen,height=1596\sphinxpxdimen]{{examples_Periodic_function_10_0}.png}

\end{nbsphinxfancyoutput}

For l odd the results were shifted, because for small \(q\) the error is 0. Because of the symmetry of the function and the points used for the calculation the only source of an inexact approximation is the machine error.

For l even it could easily be seen that the results of section 15.2.6 could not be applied, because the the approximation would need to have the tendency to get more precise with increasing \(r\). This could not be observed.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{option = \PYGZdq{}Trapezoidal\PYGZdq{}}
\PYG{l+s+sd}{deg\PYGZus{}approx = 15}
\PYG{l+s+sd}{max\PYGZus{}dim = 6}
\PYG{l+s+sd}{r\PYGZus{}max = 5}

\PYG{l+s+sd}{results\PYGZus{}example\PYGZus{}2= np.empty((r\PYGZus{}max\PYGZhy{}1 , max\PYGZus{}dim\PYGZhy{}1, deg\PYGZus{}approx, 3))}
\PYG{l+s+sd}{for r in range(2, r\PYGZus{}max+1):}
\PYG{l+s+sd}{    print(\PYGZdq{}  \PYGZdq{})}
\PYG{l+s+sd}{    norm\PYGZus{}factor = 1}
\PYG{l+s+sd}{    variables = [\PYGZdq{}(x\PYGZus{}1)\PYGZdq{}]}
\PYG{l+s+sd}{    for k in range(1,int(np.ceil(r/2))+1):}
\PYG{l+s+sd}{        norm\PYGZus{}factor = norm\PYGZus{}factor * (2*k/(2*k\PYGZhy{}1))}

\PYG{l+s+sd}{    functions = [str(norm\PYGZus{}factor) + \PYGZdq{} sin(x\PYGZus{}\PYGZdq{}+str(1)+\PYGZdq{}*2*pi)** \PYGZdq{}+str(r)]}



\PYG{l+s+sd}{    for dim in range(2,max\PYGZus{}dim+1):}

\PYG{l+s+sd}{        variables.append(variables[\PYGZhy{}1][:\PYGZhy{}1]+\PYGZdq{}, x\PYGZus{}\PYGZdq{}+ str(dim)+\PYGZdq{})\PYGZdq{})}
\PYG{l+s+sd}{        functions.append(functions[\PYGZhy{}1]+  \PYGZdq{} * \PYGZdq{} + str(norm\PYGZus{}factor) + \PYGZdq{}* sin(x\PYGZus{}\PYGZdq{}+str(dim)+\PYGZdq{}*2*pi)** \PYGZdq{} + str(r))}

\PYG{l+s+sd}{        for q in range(dim,dim+deg\PYGZus{}approx):}
\PYG{l+s+sd}{            print(str(r) + \PYGZdq{}  \PYGZdq{} +str(dim)+ \PYGZdq{}   \PYGZdq{} + str(q))}
\PYG{l+s+sd}{            results\PYGZus{}example\PYGZus{}2[r\PYGZhy{}2,dim\PYGZhy{}2, q \PYGZhy{} dim, :] = Studieproject\PYGZus{}one.controller\PYGZus{}smolyak(functions[\PYGZhy{}1], variables[\PYGZhy{}1], option, q, example\PYGZus{}2=True)}


\PYG{l+s+sd}{results\PYGZus{}example\PYGZus{}2 = \PYGZob{} \PYGZdq{}results\PYGZdq{}: results\PYGZus{}example\PYGZus{}2\PYGZcb{}}

\PYG{l+s+sd}{bearcats.to\PYGZus{}pickle(results\PYGZus{}example\PYGZus{}2,\PYGZdq{}approx\PYGZus{}per\PYGZus{}function.pkl\PYGZdq{})}

\PYG{l+s+sd}{print(\PYGZdq{}If you want to generate data, remove quotation marks.\PYGZdq{})}
\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Remove quotes to generate data.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Remove quotes to generate data.
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{Example 15.3.8 Pertubated Coulomb Potential (PCP)}
\label{\detokenize{examples/Pertubated_Coulomb_Potential:Example-15.3.8-Pertubated-Coulomb-Potential-(PCP)}}\label{\detokenize{examples/Pertubated_Coulomb_Potential::doc}}
We want to implement the example 15.3.8 in the book Tractability of Multivariate Problems Vol 2 for 2 particles The function itself is
\begin{equation*}
\begin{split}f(x_1,x_2,\dots,x_l) = \sum_{1\leq i < j \leq l}\left(\frac{1}{\sqrt{||x_i-x_j||^{2}_{2}+\alpha}}\right)\end{split}
\end{equation*}
Where x\_i, i = 1,2,…,l are three dimensional vectors. We first choose l = 2. Using the results of the example we calculate the function by integrating
\begin{equation*}
\begin{split}\tilde{f}_{\alpha}(z_1, z_2, \dots, z_{3l})=\left(\prod^{6-1}_{j = 1}\left(j+\frac{1}{2}\right)\right) \cdot \frac{(z_1-z_4)^4(z_2-z_5)^4(z_3-z_6)^4}{((z_1-z_4)^2+(z_2-z_5)^2+(z_3-z_6)^2+\alpha)^{13}}\end{split}
\end{equation*}
over the interval {[}0,1{]}\(\sp{\text{6}}\). For higher dimension the algorithm gets extremely slow.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{colors} \PYG{k}{as} \PYG{n+nn}{colors}
\PYG{k+kn}{import} \PYG{n+nn}{time} \PYG{k}{as} \PYG{n+nn}{time}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{bearcats}
\PYG{k+kn}{import} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{integrate}
\PYG{k+kn}{import} \PYG{n+nn}{sympy}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k+kn}{import} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point} \PYG{k}{as} \PYG{n+nn}{Studieproject\PYGZus{}one}
\PYG{k+kn}{import} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}three\PYGZus{}points} \PYG{k}{as} \PYG{n+nn}{Studienprojekt\PYGZus{}three}

\end{sphinxVerbatim}
}


\section{Results of approximations}
\label{\detokenize{examples/Pertubated_Coulomb_Potential:Results-of-approximations}}
We calculated the integral for \(\alpha = 10^{-i}\) for in \(i = 0, \dots, 5\) using different quadratures up to a degree of approximation of up to 23, depending on the runtime of the algorithm. Furthermore it was possible to calculate the integral for \(i = 0\) and \(i=1\) in an acceptable amount of time and with a sufficient accuracy. On this basis we also show a lower bound of the integral for the smaller \(\alpha\) which was estimated on page 393 of the same book. First
we show the results of the approximation.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[26]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Data}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:}
    \PYG{k}{pass}
\PYG{c+c1}{\PYGZsh{} Settings needed for plotting of results.}
\PYG{n}{option\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{color\PYGZus{}str} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{fuchsia}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{navy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{limegreen}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{red}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{alpha} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.001}\PYG{p}{,} \PYG{l+m+mf}{0.0001}\PYG{p}{,} \PYG{l+m+mf}{0.00001}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} Load the result the integration of the function calculated by scipy methode nquad}
\PYG{n}{result\PYGZus{}scipy\PYGZus{}calc\PYGZus{}basic} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integral\PYGZus{}Coulomb\PYGZus{}alpha\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}


\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Load single approximation of the PCP different alphas and a wider range of degree of approximation q.}
    \PYG{n}{data} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{test\PYGZus{}higher\PYGZus{}dim\PYGZus{}approx\PYGZus{}alpha\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)} \PYG{o}{+}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Integral could only be  calculated relative exactly by the nquad for the first 2 alphas.}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{2}\PYG{p}{:}
        \PYG{n}{result\PYGZus{}scipy\PYGZus{}calc} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integral\PYGZus{}Coulomb\PYGZus{}alpha\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{} For alpha \PYGZlt{} 1 the PCP was approximated using the trapezoidal quadrature and q = 19. Higher approximations}
    \PYG{c+c1}{\PYGZsh{} would easily have taken about 5 hours.}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1}  \PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{single\PYGZus{}approx\PYGZus{}trap} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{test\PYGZus{}higher\PYGZus{}dim\PYGZus{}approx\PYGZus{}one\PYGZus{}alpha\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}only\PYGZus{}trap.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{Trapezoidal}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}

    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{}  First figure showing the absolut value of the approx in a logarithmical scale}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}


    \PYG{k}{for} \PYG{n}{k\PYGZus{}2} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}

        \PYG{n}{approx} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
        \PYG{n}{error} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}

        \PYG{n}{end\PYGZus{}of\PYGZus{}approx} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{approx}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}

        \PYG{k}{if} \PYG{n}{end\PYGZus{}of\PYGZus{}approx} \PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n}{end\PYGZus{}of\PYGZus{}approx} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{approx}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{+}\PYG{l+m+mi}{1}

        \PYG{k}{if} \PYG{n}{k\PYGZus{}2} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{2}\PYG{p}{:}
            \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{o}{+}\PYG{n}{end\PYGZus{}of\PYGZus{}approx}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{[}\PYG{p}{:}\PYG{n}{end\PYGZus{}of\PYGZus{}approx}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color} \PYG{o}{=} \PYG{n}{color\PYGZus{}str}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}

        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{o}{+}\PYG{n}{end\PYGZus{}of\PYGZus{}approx}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{approx}\PYG{p}{[}\PYG{n}{end\PYGZus{}of\PYGZus{}approx}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color} \PYG{o}{=} \PYG{n}{color\PYGZus{}str}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{o}{+}\PYG{l+m+mi}{13}\PYG{p}{,} \PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{single\PYGZus{}approx\PYGZus{}trap}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{navy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{o}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{2}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{n}{result\PYGZus{}scipy\PYGZus{}calc}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmin} \PYG{o}{=}  \PYG{l+m+mf}{5.5}\PYG{p}{,} \PYG{n}{xmax}\PYG{o}{=} \PYG{l+m+mf}{6.5}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{black}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{exact result}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{n}{result\PYGZus{}scipy\PYGZus{}calc\PYGZus{}basic}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{/}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{xmin} \PYG{o}{=}  \PYG{l+m+mf}{5.5}\PYG{p}{,} \PYG{n}{xmax}\PYG{o}{=} \PYG{l+m+mf}{6.5}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{orange}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{lower bound of result}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mf}{5.5}\PYG{p}{,}\PYG{l+m+mf}{6.5}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{!=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
                     \PYG{o}{/}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{10}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{prop}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{size}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{weight}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{result of approximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{degree of approximaiton q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Absolut value of approximation}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{18}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Second subplot showing the absolut values.}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}

    \PYG{k}{for} \PYG{n}{k\PYGZus{}2} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{approx} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
        \PYG{n}{error} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
        \PYG{n}{end\PYGZus{}of\PYGZus{}approx} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{approx}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}

        \PYG{k}{if} \PYG{n}{end\PYGZus{}of\PYGZus{}approx} \PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n}{end\PYGZus{}of\PYGZus{}approx} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{approx}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{+}\PYG{l+m+mi}{1}

        \PYG{k}{if} \PYG{n}{k\PYGZus{}2} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{2}\PYG{p}{:}
            \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{o}{+}\PYG{n}{end\PYGZus{}of\PYGZus{}approx}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{approx}\PYG{p}{[}\PYG{p}{:}\PYG{n}{end\PYGZus{}of\PYGZus{}approx}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color} \PYG{o}{=} \PYG{n}{color\PYGZus{}str}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}

        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{o}{+}\PYG{n}{end\PYGZus{}of\PYGZus{}approx}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{approx}\PYG{p}{[}\PYG{n}{end\PYGZus{}of\PYGZus{}approx}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color} \PYG{o}{=} \PYG{n}{color\PYGZus{}str}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{o}{+}\PYG{l+m+mi}{13}\PYG{p}{,} \PYG{n}{single\PYGZus{}approx\PYGZus{}trap}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{navy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{o}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mf}{5.5}\PYG{p}{,}\PYG{l+m+mf}{6.5}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{!=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{\PYGZhy{}} \PYG{n+nb}{abs}\PYG{p}{(}
        \PYG{n}{np}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{!=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}
            \PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{!=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.3}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.1}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1.1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{2}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{n}{result\PYGZus{}scipy\PYGZus{}calc}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmin} \PYG{o}{=}  \PYG{l+m+mf}{5.5}\PYG{p}{,} \PYG{n}{xmax}\PYG{o}{=} \PYG{l+m+mf}{6.5}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{black}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{exact result}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{hlines}\PYG{p}{(}\PYG{n}{result\PYGZus{}scipy\PYGZus{}calc\PYGZus{}basic}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{/}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{xmin} \PYG{o}{=}  \PYG{l+m+mf}{5.5}\PYG{p}{,} \PYG{n}{xmax}\PYG{o}{=} \PYG{l+m+mf}{6.5}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{orange}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{lower bound of result}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{loc}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{prop}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{size}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{weight}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{result of approximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{degree of approximaiton q}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize} \PYG{o}{=} \PYG{l+m+mi}{14}\PYG{p}{,}\PYG{n}{fontweight} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{yticks}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{ticklabel\PYGZus{}format}\PYG{p}{(}\PYG{n}{style}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sci}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{both}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Real value of approximation}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{18}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Approximation for alpha = }\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}



    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=955\sphinxpxdimen,height=793\sphinxpxdimen]{{examples_Pertubated_Coulomb_Potential_5_0}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=920\sphinxpxdimen,height=793\sphinxpxdimen]{{examples_Pertubated_Coulomb_Potential_5_1}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=914\sphinxpxdimen,height=793\sphinxpxdimen]{{examples_Pertubated_Coulomb_Potential_5_2}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=915\sphinxpxdimen,height=793\sphinxpxdimen]{{examples_Pertubated_Coulomb_Potential_5_3}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=914\sphinxpxdimen,height=793\sphinxpxdimen]{{examples_Pertubated_Coulomb_Potential_5_4}.png}

\end{nbsphinxfancyoutput}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=912\sphinxpxdimen,height=793\sphinxpxdimen]{{examples_Pertubated_Coulomb_Potential_5_5}.png}

\end{nbsphinxfancyoutput}

Often the deterministic quadratures the Smolyak algorithm seems approximate the integral for bigger \(\alpha\) in a proper way. Never the less the error bounds are far away from being sufficiently small. In most cases these are bigger than the absolute value of the results. For alpha = 0.01 even the approximation using the trapezoidal algorithm for q = 19 is negative.

Especially the result for the non\sphinxhyphen{}deterministic quadratures are varying by several orders of magnitude. Aaprt from this the error estimation for the non\sphinxhyphen{}deterministic quadratures are also varying by several magnitudes depending on whether the estimation of the variance includes points near the maximum of the function. In this case it is not possible to say, applying these has advantages compared to especially the trapezoidal quadrature.

It should be noted, that reducing the number of points used by the one dimensional quadratures for q = 1 for this function implies that for q \textless{} 4 the result of the approximation is 0.

For the sake of completeness, we show the error estimation of the different algorithms below.


\section{Error estimation}
\label{\detokenize{examples/Pertubated_Coulomb_Potential:Error-estimation}}
{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[27]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{font}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{14}\PYG{p}{,} \PYG{n}{weight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{approx\PYGZus{}simple\PYGZus{}highdim\PYGZus{}fct} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integral\PYGZus{}over\PYGZus{}one.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{alpha} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.001}\PYG{p}{,} \PYG{l+m+mf}{0.0001}\PYG{p}{,} \PYG{l+m+mf}{0.00001}\PYG{p}{]}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{18}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{data} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{test\PYGZus{}higher\PYGZus{}dim\PYGZus{}approx\PYGZus{}alpha\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)} \PYG{o}{+}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{k\PYGZus{}1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{2}\PYG{p}{:}
        \PYG{n}{result\PYGZus{}scipy\PYGZus{}calc} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integral\PYGZus{}Coulomb\PYGZus{}alpha\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}


    \PYG{n}{error} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{k\PYGZus{}2} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{error}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{n}{k\PYGZus{}2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{error} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{n}{error}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{k\PYGZus{}1}  \PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{single\PYGZus{}approx\PYGZus{}trap} \PYG{o}{=} \PYG{n}{bearcats}\PYG{o}{.}\PYG{n}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{test\PYGZus{}higher\PYGZus{}dim\PYGZus{}approx\PYGZus{}one\PYGZus{}alpha\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}only\PYGZus{}trap.pkl}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{Trapezoidal}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
        \PYG{n}{error}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{13}\PYG{p}{]}  \PYG{o}{=}  \PYG{n}{single\PYGZus{}approx\PYGZus{}trap}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{hspace}\PYG{o}{=}\PYG{l+m+mf}{0.8}\PYG{p}{,} \PYG{n}{wspace}\PYG{o}{=}\PYG{l+m+mf}{0.4}\PYG{p}{)}

    \PYG{n}{mat} \PYG{o}{=} \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{3}, int((k\PYGZus{}1)/3)].pcolor(error,norm=colors.LogNorm(vmin=error[error!=0].min(), vmax=error.max()),
                   \PYG{n}{cmap}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{brg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{colorbar}\PYG{p}{(}\PYG{n}{mat}\PYG{p}{,} \PYG{n}{ax}\PYG{o}{=}\PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{3}, int((k\PYGZus{}1)/3)])

    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{3}, int((k\PYGZus{}1)/3)].set\PYGZus{}yticks([0.5,1.5,2.5,3.5])
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{3}, int((k\PYGZus{}1)/3)].set\PYGZus{}yticklabels([\PYGZdq{}N.C.\PYGZdq{},\PYGZdq{}T.\PYGZdq{}, \PYGZdq{}M.C.\PYGZdq{}, \PYGZdq{}Q.M.C.\PYGZdq{}],fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{3}, int((k\PYGZus{}1)/3)].set\PYGZus{}xlabel(\PYGZdq{}degree of approximation q\PYGZdq{},fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{3}, int((k\PYGZus{}1)/3)].set\PYGZus{}xticks([0.5,3.5,6.5,9.5])
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{3}, int((k\PYGZus{}1)/3)].set\PYGZus{}xticklabels([6,6+5,6+10,6+15],fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})
    \PYG{n}{ax}\PYG{p}{[}\PYG{p}{(}\PYG{n}{k\PYGZus{}1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{k}{3}, int((k\PYGZus{}1)/3)].set\PYGZus{}title(r\PYGZdq{}Error for \PYGZdl{}\PYGZbs{}alpha\PYGZdl{} = \PYGZdq{}+ str(alpha[k\PYGZus{}1]),fontsize=14, fontweight=\PYGZdq{}bold\PYGZdq{})

\PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error for approximation of scalar in different dimensions}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{fontweight}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bold}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=1069\sphinxpxdimen,height=669\sphinxpxdimen]{{examples_Pertubated_Coulomb_Potential_8_0}.png}

\end{nbsphinxfancyoutput}


\section{Algorithm used for calculation of data}
\label{\detokenize{examples/Pertubated_Coulomb_Potential:Algorithm-used-for-calculation-of-data}}
Below you see the algorithm, with which the integral was approximated.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{import Methodes\PYGZus{}Studienproject.Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point as Studieproject\PYGZus{}one}
\PYG{l+s+sd}{print(\PYGZdq{}remove quotes, if you want to generate data.\PYGZdq{})}
\PYG{l+s+sd}{alpha = [1, 0.1, 0.01, 0.001, 0.0001, 0.00001]}
\PYG{l+s+sd}{dim = 6}
\PYG{l+s+sd}{option\PYGZus{}list = [\PYGZdq{}Newton\PYGZhy{}Cotes\PYGZdq{},}
\PYG{l+s+sd}{               \PYGZdq{}Trapezoidal\PYGZdq{},}
\PYG{l+s+sd}{               \PYGZdq{}Monte Carlo (non\PYGZhy{}nested)\PYGZdq{},}
\PYG{l+s+sd}{                \PYGZdq{}Quasi\PYGZhy{}Monte Carlo\PYGZdq{}]}

\PYG{l+s+sd}{degree\PYGZus{}of\PYGZus{}approx = [5, 10, 17, 17, 17]}
\PYG{l+s+sd}{approx\PYGZus{}result = np.zeros((max(degree\PYGZus{}of\PYGZus{}approx),len(option\PYGZus{}list),2))}

\PYG{l+s+sd}{for k\PYGZus{}3 in range( len(alpha)):}
\PYG{l+s+sd}{    print(\PYGZdq{}\PYGZdq{})}
\PYG{l+s+sd}{    print(\PYGZdq{}alpha = \PYGZdq{}+ str(alpha[k\PYGZus{}3]))}
\PYG{l+s+sd}{    print(\PYGZdq{}\PYGZdq{})}
\PYG{l+s+sd}{    prefactor = np.sum(np.array(list(range(1,6)))+0.5)}
\PYG{l+s+sd}{    function\PYGZus{}string = str(prefactor) + \PYGZdq{} * ((z\PYGZus{}1 \PYGZhy{} z\PYGZus{}4) ** 4 * (z\PYGZus{}2 \PYGZhy{} z\PYGZus{}5) ** 4  * (z\PYGZus{}3 \PYGZhy{} z\PYGZus{}6)**4)/(((z\PYGZus{}1 \PYGZhy{} z\PYGZus{}4) ** 2 + (z\PYGZus{}2 \PYGZhy{} z\PYGZus{}5) ** 2 + (z\PYGZus{}3 \PYGZhy{} z\PYGZus{}6) ** 2 + \PYGZdq{} + str(alpha[k\PYGZus{}3])+ \PYGZdq{}) ** (13))\PYGZdq{}}
\PYG{l+s+sd}{    variables\PYGZus{}string = \PYGZdq{}(z\PYGZus{}1 , z\PYGZus{}2 , z\PYGZus{}3, z\PYGZus{}4 , z\PYGZus{}5, z\PYGZus{}6)\PYGZdq{}}

\PYG{l+s+sd}{    for k\PYGZus{}1  in range(len(option\PYGZus{}list)):}
\PYG{l+s+sd}{        print(option\PYGZus{}list[k\PYGZus{}1])}
\PYG{l+s+sd}{        for k\PYGZus{}2 in range(degree\PYGZus{}of\PYGZus{}approx[k\PYGZus{}1]):}
\PYG{l+s+sd}{            approx\PYGZus{}result[k\PYGZus{}2,k\PYGZus{}1,:] = Studieproject\PYGZus{}one.controller\PYGZus{}smolyak(function\PYGZus{}string, variables\PYGZus{}string, option\PYGZus{}list[k\PYGZus{}1], k\PYGZus{}2 + 6)[0:2]}
\PYG{l+s+sd}{            print(approx\PYGZus{}result[k\PYGZus{}2,k\PYGZus{}1,:])}
\PYG{l+s+sd}{    data = \PYGZob{}\PYGZdq{}Newton\PYGZhy{}Cotes\PYGZdq{}: [approx\PYGZus{}result[:,0,:]],\PYGZdq{}Trapezoidal\PYGZdq{}: [approx\PYGZus{}result[:,1,:]], \PYGZdq{}Monte Carlo (non\PYGZhy{}nested)\PYGZdq{}: [approx\PYGZus{}result[:,2,:]],\PYGZdq{}Quasi\PYGZhy{}Monte Carlo\PYGZdq{}: [approx\PYGZus{}result[:,3,:]]\PYGZcb{}}
\PYG{l+s+sd}{    data = bearcats.DataFrame(data=data)}
\PYG{l+s+sd}{    bearcats.to\PYGZus{}pickle(data,\PYGZdq{}test\PYGZus{}higher\PYGZus{}dim\PYGZus{}approx\PYGZus{}alpha\PYGZus{}\PYGZdq{}+ str(alpha[k\PYGZus{}3]) +\PYGZdq{}.pkl\PYGZdq{})}
\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{import scipy}
\PYG{l+s+sd}{import numpy as np}
\PYG{l+s+sd}{import pandas as bearcats}
\PYG{l+s+sd}{alpha = [1, 0.1, 0.01, 0.001, 0.0001, 0.00001]}
\PYG{l+s+sd}{dim = 6}

\PYG{l+s+sd}{approx\PYGZus{}result = np.zeros((max(degree\PYGZus{}of\PYGZus{}approx),len(option\PYGZus{}list),2))}

\PYG{l+s+sd}{for k\PYGZus{}3 in range(2,len(alpha)):}

\PYG{l+s+sd}{    prefactor = np.sum(np.array(list(range(1,6)))+0.5)}
\PYG{l+s+sd}{    function\PYGZus{}string = str(prefactor) + \PYGZdq{} * ((z\PYGZus{}1 \PYGZhy{} z\PYGZus{}4) ** 4 * (z\PYGZus{}2 \PYGZhy{} z\PYGZus{}5) ** 4  * (z\PYGZus{}3 \PYGZhy{} z\PYGZus{}6)**4)/(((z\PYGZus{}1 \PYGZhy{} z\PYGZus{}4) ** 2 + (z\PYGZus{}2 \PYGZhy{} z\PYGZus{}5) ** 2 + (z\PYGZus{}3 \PYGZhy{} z\PYGZus{}6) ** 2 + \PYGZdq{} + str(alpha[k\PYGZus{}3])+ \PYGZdq{}) ** (13))\PYGZdq{}}
\PYG{l+s+sd}{    variables\PYGZus{}string = \PYGZdq{}(z\PYGZus{}1 , z\PYGZus{}2 , z\PYGZus{}3, z\PYGZus{}4 , z\PYGZus{}5, z\PYGZus{}6)\PYGZdq{}}
\PYG{l+s+sd}{    f = Studieproject\PYGZus{}one.rewrite\PYGZus{}function(function\PYGZus{}string, variables\PYGZus{}string)[0]}
\PYG{l+s+sd}{    borders = [[0,1],[0,1],[0,1],[0,1],[0,1],[0,1]]}
\PYG{l+s+sd}{    integral = scipy.integrate.nquad(f, borders, opts = \PYGZob{}\PYGZdq{}epsrel\PYGZdq{}: 1/alpha[k\PYGZus{}3]**2, \PYGZdq{}epsabs\PYGZdq{}: 3e4/(alpha[k\PYGZus{}3])**2, \PYGZdq{}limit\PYGZdq{}: 1 \PYGZcb{})}
\PYG{l+s+sd}{    print(integral)}
\PYG{l+s+sd}{    bearcats.to\PYGZus{}pickle(integral,\PYGZdq{}integral\PYGZus{}Coulomb\PYGZus{}alpha\PYGZus{}\PYGZdq{}+str(alpha[k\PYGZus{}3])+\PYGZdq{}.pkl\PYGZdq{}}
\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Remove quotes to approximate function either using the Smolyak algorithm or the scipy.integral package in python.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Remove quotes to approximate function either using the Smolyak algorithm or the scipy.integral package in python.
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{View}
\label{\detokenize{examples/View:View}}\label{\detokenize{examples/View::doc}}
This notebook provides the possibility to use the methodes implemented by entering a function and a degree of approximation. Regarding the quadrature the option
\begin{itemize}
\item {} 
Newton\sphinxhyphen{}Cotes,

\item {} 
Trapezoidal,

\item {} 
Monte\sphinxhyphen{}Carlo (nested and not nested) and

\item {} 
Quasi\sphinxhyphen{}Monte Carlo

\end{itemize}

exist. An other way is calling the View function.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} The packages needed here are Tkinter, because the View is implemented using it}
\PYG{c+c1}{\PYGZsh{} and of course the packages of the projekt}
\PYG{k+kn}{import} \PYG{n+nn}{tkinter} \PYG{k}{as} \PYG{n+nn}{tk}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k+kn}{import} \PYG{n+nn}{Methodes\PYGZus{}Studienproject}\PYG{n+nn}{.}\PYG{n+nn}{Studienprojekt\PYGZus{}Smolyak\PYGZus{}qmc\PYGZus{}one\PYGZus{}point} \PYG{k}{as} \PYG{n+nn}{Studieproject\PYGZus{}one}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[76]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{tkinter} \PYG{k+kn}{import} \PYG{n}{messagebox} \PYG{k}{as} \PYG{n}{mbox}
\PYG{c+c1}{\PYGZsh{} View/ Main}

\PYG{c+c1}{\PYGZsh{} In this script we make an interface with tkinter}
\PYG{c+c1}{\PYGZsh{}   The interface has: \PYGZhy{} An entry line for the function}
\PYG{c+c1}{\PYGZsh{}                      \PYGZhy{} An entry line for the variables}
\PYG{c+c1}{\PYGZsh{}                      \PYGZhy{} number of evaluations}
\PYG{c+c1}{\PYGZsh{}                      \PYGZhy{} Perhaps an entry line to verify dimension}
\PYG{c+c1}{\PYGZsh{}                      \PYGZhy{} button to start calculation}
\PYG{c+c1}{\PYGZsh{}                      \PYGZhy{} A separate popup for result showing of}
\PYG{c+c1}{\PYGZsh{}                      \PYGZhy{} Drop down menu for choosing of quadrature}
\PYG{c+c1}{\PYGZsh{}                      \PYGZhy{} Several popup for warnings}
\PYG{c+c1}{\PYGZsh{} import tkinter as tk}

\PYG{c+c1}{\PYGZsh{} own files imported}
\PYG{c+c1}{\PYGZsh{} import My\PYGZus{}Controller as cont}
\PYG{c+c1}{\PYGZsh{} import controller\PYGZus{}smolyak as cont}

\PYG{c+c1}{\PYGZsh{} create main viewer}
\PYG{n}{root} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Tk}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{root}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Application for calculation of integral with Smolak algorithm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{root}\PYG{o}{.}\PYG{n}{geometry}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{800x300}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Label for description of functionality of viewer}
\PYG{n}{description} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Label}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{To  use the application you need first need to enter a function in the }\PYG{l+s+s2}{\PYGZdq{}}
                                  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{entry.}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
                                  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{After this the tuple of variables and in the end the quadrature you want to be }\PYG{l+s+s2}{\PYGZdq{}}
                                  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{used.}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
                                  \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{The calculation starts after clicking start.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{anchor}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{justify}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{left}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{description}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{sticky}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{columnspan}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} Column for entry of function}
\PYG{n}{func\PYGZus{}label} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Label}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Please enter function: }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{justify}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{center}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{anchor}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{func\PYGZus{}label}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{sticky}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{func\PYGZus{}entry} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Entry}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{borderwidth}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{func\PYGZus{}entry}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{sticky}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{e}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{columnspan}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{func\PYGZus{}entry}\PYG{o}{.}\PYG{n}{insert}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2 x y}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Column for entry of variables}
\PYG{n}{var\PYGZus{}label} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Label}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Please enter variables: }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{justify}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{center}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{anchor}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{var\PYGZus{}label}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{sticky}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{var\PYGZus{}entry} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Entry}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{borderwidth}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{var\PYGZus{}entry}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{sticky}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{e}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{columnspan}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{var\PYGZus{}entry}\PYG{o}{.}\PYG{n}{insert}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{(x , y)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Drop down menu for quadrature}

\PYG{c+c1}{\PYGZsh{} list of quadratures available}
\PYG{n}{option\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Newton\PYGZhy{}Cotes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Trapezoidal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monte Carlo (non\PYGZhy{}nested)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
               \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quasi\PYGZhy{}Monte Carlo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{option} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{StringVar}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{option}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{option\PYGZus{}list}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{which\PYGZus{}quad} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{OptionMenu}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{option}\PYG{p}{,} \PYG{o}{*}\PYG{n}{option\PYGZus{}list}\PYG{p}{)}
\PYG{n}{which\PYGZus{}quad}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}


\PYG{n}{degree\PYGZus{}label} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Label}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Please choose degree of approximation: }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{justify}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{center}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{anchor}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                        \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{degree\PYGZus{}label}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{sticky}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{degree\PYGZus{}of\PYGZus{}approx} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Entry}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{borderwidth}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{degree\PYGZus{}of\PYGZus{}approx}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{degree\PYGZus{}of\PYGZus{}approx}\PYG{o}{.}\PYG{n}{insert}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} !! Here we also could  think about a button making it possible to define the epsilon\PYGZhy{}error!!}


\PYG{c+c1}{\PYGZsh{} Start button}
\PYG{k}{def} \PYG{n+nf}{start}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}

    \PYG{c+c1}{\PYGZsh{} read out entries}
    \PYG{n}{function\PYGZus{}string} \PYG{o}{=} \PYG{n}{func\PYGZus{}entry}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{variables\PYGZus{}string} \PYG{o}{=} \PYG{n}{var\PYGZus{}entry}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{quadrature} \PYG{o}{=} \PYG{n}{option}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{degree} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{degree\PYGZus{}of\PYGZus{}approx}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} We want to open an error box, if the degree of approximation is not big enough. Hence, we need to}
    \PYG{c+c1}{\PYGZsh{} know the dimension of the function. Here we get this by counting the commas.}
    \PYG{k}{if} \PYG{n}{degree} \PYG{o}{\PYGZlt{}} \PYG{p}{(}\PYG{n}{variables\PYGZus{}string}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{mbox}\PYG{o}{.}\PYG{n}{showerror}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Input error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{The degree of the approximation needs to be at least as high as the }\PYG{l+s+s2}{\PYGZdq{}}
                                      \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dimension of m the function. }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{In this case this would be q = }\PYG{l+s+s2}{\PYGZdq{}}
                                      \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{variables\PYGZus{}string}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}


    \PYG{k}{else}\PYG{p}{:}

        \PYG{c+c1}{\PYGZsh{} ask controller for benchmarks of approximation}
        \PYG{n}{result\PYGZus{}approx}\PYG{p}{,} \PYG{n}{error}\PYG{p}{,} \PYG{n}{cost} \PYG{o}{=} \PYG{n}{Studieproject}\PYG{o}{.}\PYG{n}{controller\PYGZus{}smolyak}\PYG{p}{(}\PYG{n}{function\PYGZus{}string}\PYG{p}{,}
                                                                      \PYG{n}{variables\PYGZus{}string}\PYG{p}{,} \PYG{n}{quadrature}\PYG{p}{,} \PYG{n}{degree}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Create new window where results are shown}
        \PYG{n}{result\PYGZus{}window} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Toplevel}\PYG{p}{(}\PYG{n}{root}\PYG{p}{)}
        \PYG{n}{result\PYGZus{}window}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Result}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{result\PYGZus{}window}\PYG{o}{.}\PYG{n}{geometry}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{800x200}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Label for result of approx.}
        \PYG{n}{result\PYGZus{}label} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Label}\PYG{p}{(}\PYG{n}{result\PYGZus{}window}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{The result of the approximation is: }\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{result\PYGZus{}approx}\PYG{p}{)}\PYG{p}{,}
                                \PYG{n}{justify}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{left}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{anchor}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{e}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
        \PYG{n}{result\PYGZus{}label}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{columnspan}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Label for error}
        \PYG{n}{error\PYGZus{}label} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Label}\PYG{p}{(}\PYG{n}{result\PYGZus{}window}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Estimated error: }\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{error}\PYG{p}{)}\PYG{p}{,} \PYG{n}{justify}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{center}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{anchor}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                               \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
        \PYG{n}{error\PYGZus{}label}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Label for cost estimation}
        \PYG{n}{cost\PYGZus{}label} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Label}\PYG{p}{(}\PYG{n}{result\PYGZus{}window}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Estimated number of evaluations: }\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cost}\PYG{p}{)}\PYG{p}{,} \PYG{n}{justify}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{center}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                              \PYG{n}{anchor}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
        \PYG{n}{cost\PYGZus{}label}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Quit button of result window}
        \PYG{n}{quit\PYGZus{}button\PYGZus{}result} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Button}\PYG{p}{(}\PYG{n}{result\PYGZus{}window}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quit}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{command}\PYG{o}{=}\PYG{n}{root}\PYG{o}{.}\PYG{n}{destroy}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{borderwidth}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,}
                                       \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
        \PYG{n}{quit\PYGZus{}button\PYGZus{}result}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{}  Start button}
\PYG{n}{start\PYGZus{}button} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Button}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Start}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{command}\PYG{o}{=}\PYG{n}{start}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{borderwidth}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}

\PYG{n}{start\PYGZus{}button}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Quit button}
\PYG{n}{quit\PYGZus{}button} \PYG{o}{=} \PYG{n}{tk}\PYG{o}{.}\PYG{n}{Button}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Quit}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{command}\PYG{o}{=}\PYG{n}{root}\PYG{o}{.}\PYG{n}{destroy}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{borderwidth}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{padx}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{pady}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{quit\PYGZus{}button}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{row}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{column}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{n}{root}\PYG{o}{.}\PYG{n}{mainloop}\PYG{p}{(}\PYG{p}{)}

\end{sphinxVerbatim}
}


\section{Overview over methods defined for project}
\label{\detokenize{examples/View:Overview-over-methods-defined-for-project}}
Furthermore, an overview should be given over the methods defined in the project. These methods are written in alphabetic order.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[80]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{def} \PYG{n+nf}{write\PYGZus{}functions}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{functions}\PYG{o}{=} \PYG{p}{[}\PYG{n}{function} \PYG{k}{for} \PYG{n}{function} \PYG{o+ow}{in}  \PYG{n+nb}{dir}\PYG{p}{(}\PYG{n}{Studieproject\PYGZus{}one}\PYG{p}{)} \PYG{k}{if}
                \PYG{p}{(}\PYG{p}{(}\PYG{o+ow}{not} \PYG{n}{function}\PYG{o}{.}\PYG{n}{startswith}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o+ow}{and} \PYG{n}{function}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0} \PYG{o+ow}{and} \PYG{n}{function} \PYG{o}{!=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{parse\PYGZus{}expr}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o+ow}{or} \PYG{n}{function} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smolyak}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{k\PYGZus{}1} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{functions}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}033}\PYG{l+s+s1}{[1m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{functions}\PYG{p}{[}\PYG{n}{k\PYGZus{}1}\PYG{p}{]}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}033}\PYG{l+s+s1}{[0m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{write\PYGZus{}functions}\PYG{p}{(}\PYG{p}{)}

\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\textbf{calculate\_stat\_data

}\textbf{controller\_smolyak

}\textbf{cost\_smolyak

}\textbf{epsilon\_cost

}\textbf{error\_smolyak

}\textbf{find\_all\_sensible\_combinations

}\textbf{find\_next\_tuples\_index

}\textbf{find\_right\_position

}\textbf{implicit\_multiplication

}\textbf{load\_stat\_data

}\textbf{modified\_scatter\_plot

}\textbf{monte\_carlo\_quad

}\textbf{newton\_cotes

}\textbf{next\_step

}\textbf{one\_dim\_newton\_cotes

}\textbf{one\_dim\_trapezoidal

}\textbf{qmc\_quad

}\textbf{rewrite\_function

}\textbf{slice\_find

}\textbf{smolyak

}\textbf{sort\_tuples

}\textbf{standard\_transformations

}\textbf{sum\_tuple\_shape

}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{Documentation}
\label{\detokenize{index:module-Studienprojekt_Smolyak_qmc_one_point}}\label{\detokenize{index:documentation}}\index{module@\spxentry{module}!Studienprojekt\_Smolyak\_qmc\_one\_point@\spxentry{Studienprojekt\_Smolyak\_qmc\_one\_point}}\index{Studienprojekt\_Smolyak\_qmc\_one\_point@\spxentry{Studienprojekt\_Smolyak\_qmc\_one\_point}!module@\spxentry{module}}\index{View() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{View()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.View}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{View}}}{}{}
View of project
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
None

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_stat\_data() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{calculate\_stat\_data()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.calculate_stat_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{calculate\_stat\_data}}}{\emph{\DUrole{n}{function\_string\_stat\_calc}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{var\_string}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{option\_list\_quad}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{filename}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{degree\_of\_app\_range}\DUrole{p}{:} \DUrole{n}{list}}, \emph{\DUrole{n}{repetitions}\DUrole{o}{=}\DUrole{default_value}{1024}}, \emph{\DUrole{n}{damping}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{damping\_exp}\DUrole{o}{=}\DUrole{default_value}{1.5}}}{}
This method calculates and saves the result, error and runtime Smolyak approximation for the quadratures
\# given in option\_list several times.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{function\_string\_stat\_calc}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}) \textendash{} function for which the integral should be approximated.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{var\_string}} (\sphinxstyleliteralemphasis{\sphinxupquote{sting}}) \textendash{} variables of function for which the integral should be approximated.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{option\_list\_quad}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} list with the quadratures that should be used.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}) \textendash{} name of the file in which you want to save the data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{degree\_of\_app\_range}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} list with degrees of approximation, for which data should be generated
repetitions: Times the results  are generated.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{repetitions}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Times the results  are generated.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{damping}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} boolean saying, whether the number of repetition should decrease according to the
degree of approximation. Depending on the range of degrees of approximation and the computer recommendable,
default is True.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{damping\_exp}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} damping exponent of the degree of approximation, if damping is true.

\end{itemize}

\item[{Raises}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If one of the quadrature is not defined.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If the filename is not valid

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If degree\_of\_app\_range does not have the right length.

\end{itemize}

\item[{Returns}] \leavevmode
None

\end{description}\end{quote}

\end{fulllineitems}

\index{controller\_smolyak() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{controller\_smolyak()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.controller_smolyak}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{controller\_smolyak}}}{\emph{\DUrole{n}{function\_string\_control}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{variables\_string\_control}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{quadrature}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{no\_error}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{function\_given}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{example\_2}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{1}}}{}
Controller of project
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{function\_string\_control}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} string in which the function is defined

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{variables\_string\_control}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} string for safe use, to be sure that right variables are used in function

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{quadrature}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} variable with 4 options to choose quadrature that should be used for approx

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} degree of approximation

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{no\_error}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Decides, if error should be calculated. (Sometimes the time can be reduced
relevantly.) Default is set to False.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{function\_given}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Needs to be set to true, if a callable function already is given.
In this case the input function\_string\_control needs to be a callable function and variable\_string\_control
need to be a list of sympy.variables, default set to False.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{example\_2}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Defined for example 2. In this case the quadrature is open, default set to False.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} lower limit of interval, default set to 0.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} upper limit of interval, default set to 1.

\end{itemize}

\item[{Raises}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If the type of quadraute chosen is not defined.

\item[{Returns}] \leavevmode
result of approximaiton, upper bound of error of approximation and upper bound of cost.

\item[{Return type}] \leavevmode
{[}float, float, float{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{cost\_smolyak() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{cost\_smolyak()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.cost_smolyak}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{cost\_smolyak}}}{\emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{dim}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{nested}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{is\_rand}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{example\_2}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{give\_param}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
Methode giving back an estimation of the cardinality of the information needed for the algorithm.
Due to the definition of the. sequences of the one dimensional algorithms used, the cost could be calculated
relatively quickly
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Degree of approximation

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{dim}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Dimension

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{nested}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Decides if information is nested, default True.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{is\_rand}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Decides if quadrature is probabilistic, default is False.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{example\_2}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Mainly defined for example 2. Decides, if the quadrature is open, default is False.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{give\_param}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Decides, if the cost estimation or the parameters are returned, default is False.

\end{itemize}

\item[{Returns}] \leavevmode
estimated cost of approximation.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{epsilon\_cost() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{epsilon\_cost()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.epsilon_cost}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{epsilon\_cost}}}{\emph{function\_string: str}, \emph{variable\_string: str}, \emph{quadrature: str}, \emph{epsilon: \textless{}module \textquotesingle{}numbers\textquotesingle{} from \textquotesingle{}/usr/local/Cellar/python@3.9/3.9.0\_5/Frameworks/Python.framework/Versions/3.9/lib/python3.9/numbers.py\textquotesingle{}\textgreater{}}, \emph{nested=False}, \emph{open=False}}{}
Methode calculating the epsilon error
:param function\_string: string of function
:type function\_string: str
:param variable\_string: string of variables
:type variable\_string: str
:param quadrature: string of one\sphinxhyphen{}dimensional quadrature to use
:type quadrature: str
:param epsilon: upper bound of error
:type epsilon: float
:param nested: Decides if the equation for nested or not nested information is used, default is
:type nested: boolean, optional
:param False.:
:param open: Decides if a open or closed quadrature is used, default is
:type open: boolean, optional
:param False.:
\begin{quote}\begin{description}
\item[{Raises}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} Exception: If the quadrature chosen is not implemented.

\item[{Returns}] \leavevmode
The estimated error and cost estimation.

\item[{Return type}] \leavevmode
{[}float, float{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{error\_smolyak() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{error\_smolyak()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.error_smolyak}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{error\_smolyak}}}{\emph{\DUrole{n}{f}}, \emph{\DUrole{n}{quadrature}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{variables}}, \emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{function\_string\_error}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{give\_parameters}\DUrole{o}{=}\DUrole{default_value}{False}}}{}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{f}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}) \textendash{} callable sympy function

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{quadrature}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} quadrature used

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{variables}} (\sphinxstyleliteralemphasis{\sphinxupquote{sympy.variables}}) \textendash{} sympy variables of function

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} degree of approximation

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{function\_string\_error}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} string of function. (Needed, because analytically deriving strings is easier than

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{functions}}\sphinxstyleliteralstrong{\sphinxupquote{)}} (\sphinxstyleliteralemphasis{\sphinxupquote{deriving}}) \textendash{} 

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} lower limit of interval, default to 0.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} upper limit of interval, default to 1.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{give\_parameters}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Boolean defined to get the parameters of the error estimation instead of

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{error estimation}} (\sphinxstyleliteralemphasis{\sphinxupquote{the}}) \textendash{} 

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{set to False.}} (\sphinxstyleliteralemphasis{\sphinxupquote{default}}) \textendash{} 

\end{itemize}

\item[{Raises}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If the quadrature chosen is not implemented

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If deterministic quadratures are used and the function can not be derived sufficiently many times.

\end{itemize}

\item[{Returns}] \leavevmode
error of estimation

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{fast\_eps\_cost() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{fast\_eps\_cost()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.fast_eps_cost}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{fast\_eps\_cost}}}{\emph{\DUrole{n}{dim}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{B}\DUrole{p}{:} \DUrole{n}{float}}, \emph{\DUrole{n}{C}\DUrole{p}{:} \DUrole{n}{float}}, \emph{\DUrole{n}{D}\DUrole{p}{:} \DUrole{n}{float}}, \emph{\DUrole{n}{F\_0}\DUrole{p}{:} \DUrole{n}{float}}, \emph{\DUrole{n}{F}\DUrole{p}{:} \DUrole{n}{float}}, \emph{\DUrole{n}{epsilon}\DUrole{p}{:} \DUrole{n}{float}}, \emph{\DUrole{n}{q}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{is\_nested}\DUrole{o}{=}\DUrole{default_value}{True}}}{}
Function for the fast calc. of eps cost, if all parameters are given
:param dim: dimension
:type dim: int
:param B: Estim. of norm of operator
:type B: float
:param C: Estim. of linear part of approx error
:type C: float
:param D: Estim. of exp. part of approx error
:type D: float
:param F\_0: Estim. of linear part of costs
:type F\_0: float
:param F: Estim. of exp. part of cost
:type F: float
:param epsilon: epsilon error chosen
:type epsilon: float
:param q: degree of approximation
:type q: int, optional
:param is\_nested: Decides if the equation for nested or not nested information is used, default is
:type is\_nested: boolean, optional
:param True.:
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The epsilon cost

\end{description}\end{quote}

\end{fulllineitems}

\index{find\_all\_sensible\_combinations() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{find\_all\_sensible\_combinations()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.find_all_sensible_combinations}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{find\_all\_sensible\_combinations}}}{\emph{\DUrole{n}{dim}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}}{}
Methode finding all tuples of combinations of one dim approximations necessary to calc. Smol. alg..
:param dim: dimension of vectors
:type dim: int
:param q: maximal cumulative sum
:type q: int
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
List of all combination of degrees of approximation needed for later calculations.

\item[{Return type}] \leavevmode
list

\end{description}\end{quote}

\end{fulllineitems}

\index{find\_next\_tuples\_index() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{find\_next\_tuples\_index()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.find_next_tuples_index}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{find\_next\_tuples\_index}}}{\emph{\DUrole{n}{current\_tuple}\DUrole{p}{:} \DUrole{n}{tuple}}, \emph{\DUrole{n}{tuple\_list}\DUrole{p}{:} \DUrole{n}{list}}}{}
Method to find the function evaluation matrix with the most reusable function values
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{current\_tuple}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} Tuple saving the degree of approximation currently used for the approximation

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{tuple\_list}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} list of tuples for which the evaluations are stored.

\end{itemize}

\item[{Returns}] \leavevmode
The index of the evaluations with the most reusable evaluations.

\item[{Return type}] \leavevmode
integer

\end{description}\end{quote}

\end{fulllineitems}

\index{find\_right\_position() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{find\_right\_position()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.find_right_position}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{find\_right\_position}}}{\emph{\DUrole{n}{current\_vector}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{pointer\_current\_position}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{max\_value}\DUrole{p}{:} \DUrole{n}{int}}}{}
Decides, where to add one.
:param current vector: Current combination of degrees of approximation.
:type current vector: np.array
:param pointer\_current\_position: index of dimension, in which needs  to be changed next.
:type pointer\_current\_position: int
:param max\_value: upper bound of degrees of approximation needed in set.
:type max\_value: int
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
highest position that needs to be changed in next step

\item[{Return type}] \leavevmode
pointer\_current\_position (int)

\end{description}\end{quote}

\end{fulllineitems}

\index{load\_stat\_data() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{load\_stat\_data()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.load_stat_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{load\_stat\_data}}}{\emph{\DUrole{n}{filename}\DUrole{p}{:} \DUrole{n}{str}}}{}
Method loading the formerly saved data to the memory. !! This method only should be used for the
calculate\_stat\_data, because the data structure is relatively specific.
:param filename: string of name of file that should be loaded.
\begin{quote}\begin{description}
\item[{Raises}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If the file name has the wrong format.

\item[{Returns}] \leavevmode
Contains the results of the approximation.

\item[{Return type}] \leavevmode
List

\end{description}\end{quote}

\end{fulllineitems}

\index{modified\_scatter\_plot() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{modified\_scatter\_plot()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.modified_scatter_plot}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{modified\_scatter\_plot}}}{\emph{\DUrole{n}{x}}, \emph{\DUrole{n}{y}}, \emph{\DUrole{n}{title}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Gridpoints used for Smolyak\sphinxhyphen{}algorithm\textquotesingle{}}}, \emph{\DUrole{n}{input\_list}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{1}}}{}
Methode quickly applying some basic modifications to a scatter plot of the gridpoints
used for the Smolyak algorithm
:param x: list of x\sphinxhyphen{}values of points
:type x: list
:param y: list of y\sphinxhyphen{}values of points
:type y: list
:param title: title of plot
:type title: str
:param input\_list: Boolean saying, whether input is list. If True, the points in different
\begin{quote}

lists are plotted in different colours, default is False.
\end{quote}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} lower border of interval

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} upper border of interval

\end{itemize}

\item[{Returns}] \leavevmode
None

\end{description}\end{quote}

\end{fulllineitems}

\index{monte\_carlo\_quad() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{monte\_carlo\_quad()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.monte_carlo_quad}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{monte\_carlo\_quad}}}{\emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{1}}}{}
Monte Carlo quadrature

This function computes the nodes and weights for the 1D Monte carlo quadrature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} degree of approximation. Number of nodes, m = 2\textasciicircum{}(q\sphinxhyphen{}1)+1.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Lower boundary of integral. Defaults to 0.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Upper boundary of integral. Defaults to 1.

\end{itemize}

\item[{Raises}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} a and b need to be real numbers.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} b as the upper boundary has to be bigger than a.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} q needs to be an integer.

\end{itemize}

\item[{Returns}] \leavevmode
nodes and weights for the 1D Monte carlo quadrature of degree q.

\item[{Return type}] \leavevmode
{[}array, array{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{next\_step() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{next\_step()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.next_step}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{next\_step}}}{\emph{\DUrole{n}{current\_vector}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{pointer\_current\_position}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{max\_value}\DUrole{p}{:} \DUrole{n}{int}}}{}
Methode returning, were and what to change in the vectors determining, what one dimensional degree of
approximation should be applied. (Internal function)
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{vector}} (\sphinxstyleliteralemphasis{\sphinxupquote{current}}) \textendash{} full actual vector. (Could be reduced in most cases)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{pointer\_current\_position}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} position currently worked at

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{max\_value}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} necessary to decide when to skip to the next position

\end{itemize}

\item[{Returns}] \leavevmode
The position at which the value needs to be incremented, the next value and a pointer showing,
in which dimension the next action needs to be performed.

\item[{Return type}] \leavevmode
{[}int, int, int{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{one\_dim\_newton\_cotes() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{one\_dim\_newton\_cotes()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.one_dim_newton_cotes}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{one\_dim\_newton\_cotes}}}{\emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{1}}}{}
Newton\sphinxhyphen{}Cotes quadrature

This function computes the nodes and weights for the 1D Newton\sphinxhyphen{}Cotes quadrature.
This is a program helping me getting into programming. On the internet better implementation of
this very basic and not very precise quadrature. Apart from this, the quadrature will be used for the
testing of the viewer at the start. !! Effectively we have the open Newton\sphinxhyphen{}cotes formula of the degree (2\textasciicircum{}q \sphinxhyphen{} 1)!!
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Degree of quadrature.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Lower boundary of integral. Defaults to 0.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Upper boundary of integral. Defaults to 1.

\end{itemize}

\item[{Raises}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} a and b need to be real numbers.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} b as the upper boundary has to be bigger than a.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} q needs to be an integer.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} Please choose q \textless{} 6 for the Newton\sphinxhyphen{}Cotes approximation to avoid numerical errors.

\end{itemize}

\item[{Returns}] \leavevmode
nodes and weights for the 1D Newton\sphinxhyphen{}Cotes quadrature of degree q.

\item[{Return type}] \leavevmode
{[}array, array{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{one\_dim\_trapezoidal() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{one\_dim\_trapezoidal()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.one_dim_trapezoidal}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{one\_dim\_trapezoidal}}}{\emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{example\_2}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
Trapezoidal quadrature

This function computes the nodes and the weights for the 1D trapezoidal quadrature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Degree of quadrature. The number of points used for the quadrature then is 2\textasciicircum{}q

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Lower boundary of integral. Defaults to 0.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Upper boundary of integral. Defaults to 1.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{example\_2}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Boolean only defined for the example with the periodic, derivable functions.
If this variable is true, the borders of the interval are not used.

\end{itemize}

\item[{Raises}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} a and b need to be real numbers.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} b as the upper boundary has to be bigger than a.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} q needs to be an integer.

\end{itemize}

\item[{Returns}] \leavevmode
nodes and the weights for the 1D trapezoidal quadrature of degree q.

\item[{Return type}] \leavevmode
{[}array, array{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{qmc\_quad() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{qmc\_quad()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.qmc_quad}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{qmc\_quad}}}{\emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{1}}}{}
Quasi\sphinxhyphen{}Monte Carlo quadrature

This function computes the nodes and weights for the 1D Quasi Monte carlo quadrature using lattice rules.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} degree of approximation. Number of nodes, m = 2\textasciicircum{}q.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Lower boundary of integral. Defaults to 0.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Upper boundary of integral. Defaults to 1.

\end{itemize}

\item[{Raises}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} a and b need to be real numbers.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} b as the upper boundary has to be bigger than a.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} q needs to be an integer.

\end{itemize}

\item[{Returns}] \leavevmode
nodes and weights for the 1D QMC quadrature of degree q.

\item[{Return type}] \leavevmode
{[}array, array{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{rewrite\_function() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{rewrite\_function()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.rewrite_function}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{rewrite\_function}}}{\emph{\DUrole{n}{function\_string\_rewrite}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{variables\_string\_rewrite}\DUrole{p}{:} \DUrole{n}{str}}, \emph{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{1}}}{{ $\rightarrow$ list}}~\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{function\_string\_rewrite}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} function to be approximated

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{variables\_string\_rewrite}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} variables used in function

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} lower border of interval

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} upper border of interval

\end{itemize}

\item[{Raises}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If no variable defined.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If the set of variables used in function and defined in variable  string do not coincide.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{description}
\item[{function and variable used for approximation. String rewritten}] \leavevmode
with standardized variables.

\end{description}


\item[{Return type}] \leavevmode
{[}sympy.function, sympy.variables, string{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{slice\_find() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{slice\_find()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.slice_find}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{slice\_find}}}{\emph{\DUrole{n}{current\_shape}\DUrole{p}{:} \DUrole{n}{tuple}}, \emph{\DUrole{n}{nearest\_shape}\DUrole{p}{:} \DUrole{n}{tuple}}, \emph{\DUrole{n}{open\_quad}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
Method giving returning slices that make it possible to find old evaluations can be used
for the calculation of the current summand and the points for that further evaluation are needed.
:param current\_shape: Tuple storing the number of evaluations used for the current approximation.
:type current\_shape: tuple
:param nearest\_shape: Tuple storing the number of evaluations used for a former evaluation
:type nearest\_shape: tuple
:param open\_quad: Only defined for example 2. If this is true, the borders of the interval are not
\begin{quote}

used, default to False.
\end{quote}
\begin{quote}\begin{description}
\item[{Raises}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} A unforeseen combination of values occurred.

\item[{Returns}] \leavevmode
\begin{description}
\item[{Three d dimensional lists of slices are returned. In these the slice at the i\sphinxhyphen{}th position}] \leavevmode
coincide with the points used in this dimension.

\end{description}

list1: Positions at which a new evaluation is needed.
list2: Positions at which old evaluations can be used.
list3: Positions of the weights multiplied with the old evaluations.


\item[{Return type}] \leavevmode
{[}list1, list2, list3{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{smolyak() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{smolyak()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.smolyak}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{smolyak}}}{\emph{\DUrole{n}{f}}, \emph{\DUrole{n}{dim}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{weights}\DUrole{p}{:} \DUrole{n}{list}}, \emph{\DUrole{n}{points}\DUrole{p}{:} \DUrole{n}{list}}, \emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}, \emph{\DUrole{n}{is\_nested}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{example\_2}\DUrole{o}{=}\DUrole{default_value}{False}}}{{ $\rightarrow$ list}}
The Smolyak algorithm

Method to compute an approximation of the integral of a function using the Smolyak algorithm.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{f}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}) \textendash{} Callable sympy function.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{dim}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Dimension of the function f.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{weights}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Numpy array with saved 1D weights corresponding to the points.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{points}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Points on which the function is evaluated for the 1D integral approx.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Degree of approximation.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{is\_nested}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Boolean defined for the case that the information used is nested. Defaults to False.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{example\_2}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Boolean only defined for the example with the periodic, derivable functions.
If this variable is true, the borders of the interval are not used.

\end{itemize}

\item[{Raises}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} The list of points and weights given for the Smolyak have incorrect lengths.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} The dimensions of the 1D gridpoints and weights do not match.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} Something went wrong with the usage of the nested information.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} Up to now the input vectors should be one dimensional but are not.

\end{itemize}

\item[{Returns}] \leavevmode
result of approximation

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{sort\_tuples() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{sort\_tuples()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.sort_tuples}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{sort\_tuples}}}{\emph{\DUrole{n}{list\_of\_tuples}\DUrole{p}{:} \DUrole{n}{list}}, \emph{\DUrole{n}{q}\DUrole{p}{:} \DUrole{n}{int}}}{}
If we want to use the advantages of nested information, for this it is easier to first need to sort the list of
tuples in a way, that we first evaluate the function in a systematical way. This sorting is done here.
Starting  with the first dimension we sort the list in a rising order.

This means: input = {[}(2,1,4),(1,2,2),(1,1,1),(2,1,2){]} \textendash{}\textgreater{} {[}(1,1,1),(1,2,2),(2,1,2),(2,1,4){]}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{list\_of\_tuples}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of tuples that needs to be sorted in a specific order.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{q}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Degree of approximation

\end{itemize}

\item[{Returns}] \leavevmode
Sorted list of tuples.

\item[{Return type}] \leavevmode
list

\end{description}\end{quote}

\end{fulllineitems}

\index{sum\_tuple\_shape() (in module Studienprojekt\_Smolyak\_qmc\_one\_point)@\spxentry{sum\_tuple\_shape()}\spxextra{in module Studienprojekt\_Smolyak\_qmc\_one\_point}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Studienprojekt_Smolyak_qmc_one_point.sum_tuple_shape}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Studienprojekt\_Smolyak\_qmc\_one\_point.}}\sphinxbfcode{\sphinxupquote{sum\_tuple\_shape}}}{\emph{\DUrole{n}{old\_shape}\DUrole{p}{:} \DUrole{n}{tuple}}, \emph{\DUrole{n}{new\_shape}\DUrole{p}{:} \DUrole{n}{tuple}}}{}
Function summing up the dimension of the old information used in the way necessary here.
This means that if the dimension is the same, this value is saved. In other case, the values are summed up.
Example: (33,3) + (32,3)  = (65,3).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{old\_shape}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} Dimension of the used information.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{new\_shape}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} Dimension of the used information.

\end{itemize}

\item[{Raises}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} The input data needs to have the same lengths.

\item[{Returns}] \leavevmode
Combined shape of information.

\item[{Return type}] \leavevmode
tuple

\end{description}\end{quote}

\end{fulllineitems}



\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{s}
\item\relax\sphinxstyleindexentry{Studienprojekt\_Smolyak\_qmc\_one\_point}\sphinxstyleindexpageref{index:\detokenize{module-Studienprojekt_Smolyak_qmc_one_point}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}